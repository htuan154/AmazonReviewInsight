<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o C√°o Ng√†y 1 - D·ª± ƒêo√°n T√≠nh H·ªØu √çch Reviews Amazon</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .meta-info {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .meta-item {
            text-align: center;
        }
        
        .meta-item strong {
            display: block;
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .meta-item span {
            color: #666;
            font-size: 0.9em;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 50px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .section h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }
        
        .team-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .team-card h3 {
            color: #667eea;
            margin-top: 0;
            font-size: 1.8em;
        }
        
        .task-list {
            list-style: none;
            margin-top: 15px;
        }
        
        .task-list li {
            padding: 10px;
            margin-bottom: 8px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        
        .task-list li::before {
            content: "+ ";
            color: #28a745;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }
        
        .stat-card .label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .insight-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .insight-box h4 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        
        .insight-box p {
            color: #856404;
            line-height: 1.8;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .formula {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            border-radius: 5px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        table thead {
            background: #667eea;
            color: white;
        }
        
        table th, table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        table tbody tr:hover {
            background: #f5f5f5;
        }
        
        .comparison-table {
            margin: 20px 0;
        }
        
        .comparison-table th {
            background: #764ba2;
        }
        
        .highlight-positive {
            color: #28a745;
            font-weight: bold;
        }
        
        .highlight-negative {
            color: #dc3545;
            font-weight: bold;
        }
        
        .chart-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 300px;
            margin: 20px 0;
        }
        
        .bar {
            width: 60px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: all 0.3s;
        }
        
        .bar:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }
        
        .bar-label {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-weight: bold;
            color: #667eea;
        }
        
        .bar-value {
            position: absolute;
            bottom: -30px;
            width: 100%;
            text-align: center;
            font-size: 0.9em;
            color: #666;
        }
        
        .recommendation-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .recommendation-box h4 {
            color: #155724;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        
        .recommendation-box ul {
            margin-left: 20px;
            color: #155724;
        }
        
        .recommendation-box li {
            margin-bottom: 8px;
        }
        
        footer {
            background: #343a40;
            color: white;
            text-align: center;
            padding: 30px;
        }
        
        footer a {
            color: #667eea;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .badge-success {
            background: #28a745;
            color: white;
        }
        
        .badge-warning {
            background: #ffc107;
            color: #333;
        }
        
        .badge-info {
            background: #17a2b8;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä B√°o C√°o Ng√†y 1</h1>
            <p>D·ª± √Ån: D·ª± ƒêo√°n T√≠nh H·ªØu √çch Reviews Amazon</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Thi·∫øt L·∫≠p H·∫° T·∫ßng & Ph√¢n T√≠ch D·ªØ Li·ªáu Kh√°m Ph√°</p>
        </header>
        
        <div class="meta-info">
            <div class="meta-item">
                <strong>17,328,314</strong>
                <span>T·ªïng Reviews</span>
            </div>
            <div class="meta-item">
                <strong>9.4 GB</strong>
                <span>Dataset Parquet</span>
            </div>
            <div class="meta-item">
                <strong>1997-2023</strong>
                <span>Kho·∫£ng Th·ªùi Gian</span>
            </div>
            <div class="meta-item">
                <strong>25%</strong>
                <span>Reviews H·ªØu √çch</span>
            </div>
        </div>
        
        <div class="content">
            <!-- Team Overview -->
            <div class="section">
                <h2>üë• Th√†nh Vi√™n Nh√≥m & C√¥ng Vi·ªác Ho√†n Th√†nh</h2>
                <div class="team-grid">
                    <div class="team-card">
                        <h3>Tu·∫•n - H·∫° T·∫ßng <span class="badge badge-success">HO√ÄN TH√ÄNH</span></h3>
                        <ul class="task-list">
                            <li>Thi·∫øt l·∫≠p HDFS cluster (localhost:9000)</li>
                            <li>Upload d·ªØ li·ªáu th√¥: 7.8GB reviews + 1.2GB metadata</li>
                            <li>X√¢y d·ª±ng Spark ETL pipeline v·ªõi PySpark</li>
                            <li>Chu·∫©n h√≥a schema & chuy·ªÉn ƒë·ªïi ki·ªÉu d·ªØ li·ªáu</li>
                            <li>S·ª≠a l·ªói timestamp parsing (ms ‚Üí gi√¢y)</li>
                            <li><strong>T√≠ch h·ª£p metadata: 748K s·∫£n ph·∫©m v·ªõi brand/category/price</strong></li>
                            <li>T·∫°o 9.4GB Parquet (ph√¢n v√πng theo nƒÉm/th√°ng)</li>
                            <li>Feature engineering c∆° b·∫£n: review_length, is_helpful</li>
                            <li>B√°o c√°o EDA: class imbalance & ph√¢n b·ªë helpful votes</li>
                        </ul>
                    </div>
                    
                    <div class="team-card">
                        <h3>Thanh - Khoa H·ªçc D·ªØ Li·ªáu <span class="badge badge-success">HO√ÄN TH√ÄNH</span></h3>
                        <ul class="task-list">
                            <li>ƒê·ªãnh nghƒ©a bi·∫øn m·ª•c ti√™u (ng∆∞·ª°ng is_helpful)</li>
                            <li>Ph√¢n t√≠ch class imbalance (t·ª∑ l·ªá 3:1)</li>
                            <li>Pipeline ti·ªÅn x·ª≠ l√Ω text (clean_text UDF)</li>
                            <li>T√≠ch h·ª£p ph√¢n t√≠ch sentiment VADER</li>
                            <li>Ph√¢n t√≠ch ph√¢n b·ªë ƒë·ªô d√†i review</li>
                            <li>T∆∞∆°ng quan star rating vs helpfulness</li>
                            <li>T√≠nh to√°n pos_weight khuy·∫øn ngh·ªã = 2.995</li>
                            <li>T·∫°o b√°o c√°o EDA to√†n di·ªán</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Dataset Overview -->
            <div class="section">
                <h2>üì¶ T·ªïng Quan Dataset</h2>
                <p style="font-size: 1.1em; line-height: 1.8;">
                    <strong>Dataset:</strong> Amazon Reviews 2023 - Movies and TV<br>
                    <strong>Ngu·ªìn:</strong> UCSD Amazon Review Data (2023 release)<br>
                    <strong>K√≠ch th∆∞·ªõc g·ªëc:</strong> 7.82GB reviews JSONL + 1.2GB metadata JSONL<br>
                    <strong>Sau x·ª≠ l√Ω:</strong> 9.4GB Parquet v·ªõi compression Snappy
                </p>
                
                <h3>Schema Cu·ªëi C√πng (16 c·ªôt)</h3>
                <div class="code-block">
root
 |-- product_id: string          // M√£ s·∫£n ph·∫©m (parent ASIN)
 |-- review_id: string           // M√£ review (ASIN identifier)
 |-- review_text: string         // N·ªôi dung review (text ch√≠nh)
 |-- star_rating: double         // ƒê√°nh gi√° 1.0 - 5.0 sao
 |-- helpful_votes: long         // S·ªë l∆∞·ª£t vote h·ªØu √≠ch
 |-- user_id: string             // M√£ ng∆∞·ªùi ƒë√°nh gi√°
 |-- ts: timestamp               // Th·ªùi gian review (ƒë√£ s·ª≠a: ms ‚Üí gi√¢y)
 
 // ===== C√ÅC TR∆Ø·ªúNG METADATA (M·ªöI) =====
 |-- product_title: string       // T√™n/ti√™u ƒë·ªÅ s·∫£n ph·∫©m
 |-- brand: string               // T√™n th∆∞∆°ng hi·ªáu/c·ª≠a h√†ng
 |-- category: string            // Danh m·ª•c ch√≠nh (Movies and TV)
 |-- price: double               // Gi√° s·∫£n ph·∫©m (parsed t·ª´ string)
 |-- product_avg_rating_meta: double  // ƒê√°nh gi√° trung b√¨nh t·ª´ metadata
 |-- product_total_ratings: integer   // T·ªïng s·ªë l∆∞·ª£t ƒë√°nh gi√°
 
 // ===== C√ÅC FEATURES ƒê√É T·∫†O =====
 |-- review_length: integer      // S·ªë t·ª´ trong review
 |-- is_helpful: integer         // M·ª•c ti√™u: 1 n·∫øu helpful_votes > 0, ng∆∞·ª£c l·∫°i 0
 |-- year: integer               // Tr√≠ch xu·∫•t t·ª´ timestamp
 |-- month: integer              // Tr√≠ch xu·∫•t t·ª´ timestamp
                </div>
                
                <div class="insight-box">
                    <h4>üí° S·ª≠a L·ªói Schema Quan Tr·ªçng</h4>
                    <p><strong>V·∫•n ƒë·ªÅ timestamp:</strong> D·ªØ li·ªáu g·ªëc l∆∞u timestamp d·∫°ng milliseconds, d·∫´n ƒë·∫øn nƒÉm 62,000+ khi parse. Spark mong ƒë·ª£i seconds.</p>
                    <div class="formula">
from_unixtime(col("ts_raw").cast("bigint") / 1000).cast("timestamp")
                    </div>
                    <p>K·∫øt qu·∫£: C√°c nƒÉm h·ª£p l·ªá t·ª´ 1997-2023 v·ªõi 27 th∆∞ m·ª•c ph√¢n v√πng.</p>
                    
                    <p style="margin-top: 15px;"><strong>T√≠ch H·ª£p Metadata:</strong> Th√†nh c√¥ng t√≠ch h·ª£p 748,224 b·∫£n ghi s·∫£n ph·∫©m s·ª≠ d·ª•ng manual JSON parsing ƒë·ªÉ tr√°nh l·ªói nested struct. Left join b·∫£o to√†n t·∫•t c·∫£ 17.3M reviews.</p>
                    <p><strong>C√°c tr∆∞·ªùng m·ªõi:</strong> product_title, brand, category, price, product_avg_rating_meta, product_total_ratings</p>
                </div>
            </div>
            
            <!-- Target Definition -->
            <div class="section">
                <h2>üéØ ƒê·ªãnh Nghƒ©a Bi·∫øn M·ª•c Ti√™u</h2>
                <h3>is_helpful - Ph√¢n Lo·∫°i Nh·ªã Ph√¢n</h3>
                <p>ƒê·ªãnh nghƒ©a review l√† "helpful" (h·ªØu √≠ch) n·∫øu c√≥ √≠t nh·∫•t 1 upvote t·ª´ ng∆∞·ªùi d√πng:</p>
                <div class="formula">
is_helpful = 1 n·∫øu helpful_votes > 0, ng∆∞·ª£c l·∫°i 0
                </div>
                
                <h3>Ph√¢n T√≠ch C√°c Ng∆∞·ª°ng Thay Th·∫ø</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Ng∆∞·ª°ng</th>
                            <th>Reviews Positive</th>
                            <th>T·ª∑ L·ªá</th>
                            <th>Imbalance Ratio</th>
                            <th>ƒê√°nh Gi√°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>&gt; 0</strong></td>
                            <td class="highlight-positive">12,513 (25%)</td>
                            <td>1 : 4</td>
                            <td>3.0 : 1</td>
                            <td>‚úÖ C√¢n b·∫±ng h·ª£p l√Ω</td>
                        </tr>
                        <tr>
                            <td>&gt; 1</td>
                            <td>6,891 (13.8%)</td>
                            <td>1 : 7.3</td>
                            <td>6.3 : 1</td>
                            <td>‚ö†Ô∏è Imbalance cao</td>
                        </tr>
                        <tr>
                            <td>&gt; 2</td>
                            <td>4,431 (8.9%)</td>
                            <td>1 : 11.3</td>
                            <td>10.3 : 1</td>
                            <td>‚ùå Qu√° imbalance</td>
                        </tr>
                        <tr>
                            <td>&gt; 5</td>
                            <td>2,156 (4.3%)</td>
                            <td>1 : 23.2</td>
                            <td>22.2 : 1</td>
                            <td>‚ùå R·∫•t kh√≥ train</td>
                        </tr>
                        <tr>
                            <td>&gt; 10</td>
                            <td>1,073 (2.1%)</td>
                            <td>1 : 46.6</td>
                            <td>45.6 : 1</td>
                            <td>‚ùå Kh√¥ng kh·∫£ thi</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>üí° T·∫°i Sao Ch·ªçn Ng∆∞·ª°ng > 0?</h4>
                    <p><strong>C√¢n b·∫±ng t·ªët:</strong> Ng∆∞·ª°ng > 0 cung c·∫•p s·ª± c√¢n b·∫±ng class h·ª£p l√Ω (25% positive) trong khi v·∫´n duy tr√¨ ƒë·ªß m·∫´u training. Ng∆∞·ª°ng cao h∆°n d·∫´n ƒë·∫øn imbalance nghi√™m tr·ªçng (>10:1) ƒë√≤i h·ªèi oversampling m·∫°nh ho·∫∑c c√°c chi·∫øn l∆∞·ª£c weighting ph·ª©c t·∫°p.</p>
                </div>
            </div>
            
            <!-- Class Imbalance -->
            <div class="section">
                <h2>‚öñÔ∏è Ph√¢n T√≠ch Class Imbalance</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="number">12,513</span>
                        <span class="label">Reviews H·ªØu √çch (1)</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">37,478</span>
                        <span class="label">Reviews Kh√¥ng H·ªØu √çch (0)</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">25.0%</span>
                        <span class="label">T·ª∑ L·ªá Positive</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">3.024</span>
                        <span class="label">pos_weight Khuy·∫øn Ngh·ªã</span>
                    </div>
                </div>
                
                <h3>C√°ch T√≠nh pos_weight</h3>
                <div class="formula">
pos_weight = count(negative_class) / count(positive_class)
pos_weight = 37,478 / 12,513 = 3.024
                </div>
                
                <div class="chart-container">
                    <h4>Ph√¢n B·ªë Class (M·∫´u: 50,000 reviews)</h4>
                    <div class="bar-chart">
                        <div class="bar" style="height: 66%;">
                            <div class="bar-label">37,478</div>
                            <div class="bar-value">Kh√¥ng H·ªØu √çch</div>
                        </div>
                        <div class="bar" style="height: 22%;">
                            <div class="bar-label">12,513</div>
                            <div class="bar-value">H·ªØu √çch</div>
                        </div>
                    </div>
                </div>
                
                <div class="recommendation-box">
                    <h4>üéØ Khuy·∫øn Ngh·ªã Cho Training Model</h4>
                    <ul>
                        <li><strong>S·ª≠ d·ª•ng class_weight:</strong> ƒê·∫∑t class_weight={0: 1.0, 1: 3.024} trong LogReg/SVM</li>
                        <li><strong>Focal Loss:</strong> Cho deep learning, s·ª≠ d·ª•ng focal loss thay v√¨ CE</li>
                        <li><strong>Metric ch√≠nh: AUC-PR</strong> thay v√¨ accuracy (AUC-PR nh·∫°y v·ªõi imbalance h∆°n)</li>
                        <li><strong>Threshold tuning:</strong> T·ªëi ∆∞u threshold d·ª±a tr√™n F1 score ho·∫∑c business metric</li>
                        <li><strong>KH√îNG d√πng random oversampling:</strong> D·ªÖ overfit, ch·ªâ d√πng SMOTE n·∫øu c·∫ßn thi·∫øt</li>
                    </ul>
                </div>
            </div>
            
            <!-- Feature Analysis -->
            <div class="section">
                <h2>üìä Ph√¢n T√≠ch Features</h2>
                
                <h3>1. Ph√¢n B·ªë ƒê·ªô D√†i Review</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="number">36.7</span>
                        <span class="label">Mean T·ª´</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">84.9</span>
                        <span class="label">Std T·ª´</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">1</span>
                        <span class="label">Min T·ª´</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">5,373</span>
                        <span class="label">Max T·ª´</span>
                    </div>
                </div>
                
                <h3>ƒê·ªô D√†i Review Theo Helpfulness</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Class</th>
                            <th>Mean Length</th>
                            <th>Std</th>
                            <th>Min</th>
                            <th>Max</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Helpful (1)</strong></td>
                            <td class="highlight-positive">97.7 t·ª´</td>
                            <td>160.5</td>
                            <td>1</td>
                            <td>5,373</td>
                        </tr>
                        <tr>
                            <td><strong>Not Helpful (0)</strong></td>
                            <td class="highlight-negative">23.9 t·ª´</td>
                            <td>48.4</td>
                            <td>1</td>
                            <td>2,935</td>
                        </tr>
                        <tr>
                            <td colspan="5" style="text-align: center; background: #f8f9fa; font-weight: bold;">
                                Helpful reviews d√†i g·∫•p <span class="highlight-positive">4.08 l·∫ßn</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>üí° Review Length L√† Signal M·∫°nh Nh·∫•t</h4>
                    <p><strong>Ph√°t hi·ªán quan tr·ªçng:</strong> Reviews ƒë∆∞·ª£c vote helpful c√≥ ƒë·ªô d√†i trung b√¨nh 97.7 t·ª´, g·∫•p 4.08 l·∫ßn so v·ªõi not helpful (23.9 t·ª´). ƒê√¢y l√† feature ƒë∆°n gi·∫£n nh∆∞ng c·ª±c k·ª≥ hi·ªáu qu·∫£ cho baseline model.</p>
                    <p><strong>Gi·∫£i th√≠ch:</strong> Reviews d√†i th∆∞·ªùng ch·ª©a nhi·ªÅu chi ti·∫øt h∆°n (pros/cons, use cases, comparisons) n√™n h·ªØu √≠ch h∆°n v·ªõi ng∆∞·ªùi ƒë·ªçc. Reviews ng·∫Øn th∆∞·ªùng ch·ªâ l√† "Great!" ho·∫∑c "Bad product".</p>
                </div>
                
                <h3>2. Ph√¢n B·ªë Star Rating</h3>
                <div class="chart-container">
                    <h4>S·ªë L∆∞·ª£ng Reviews Theo Star Rating</h4>
                    <div class="bar-chart">
                        <div class="bar" style="height: 15%;">
                            <div class="bar-label">3,824</div>
                            <div class="bar-value">1 Sao</div>
                        </div>
                        <div class="bar" style="height: 10%;">
                            <div class="bar-label">2,156</div>
                            <div class="bar-value">2 Sao</div>
                        </div>
                        <div class="bar" style="height: 17%;">
                            <div class="bar-label">4,892</div>
                            <div class="bar-value">3 Sao</div>
                        </div>
                        <div class="bar" style="height: 25%;">
                            <div class="bar-label">9,103</div>
                            <div class="bar-value">4 Sao</div>
                        </div>
                        <div class="bar" style="height: 65%;">
                            <div class="bar-label">30,016</div>
                            <div class="bar-value">5 Sao</div>
                        </div>
                    </div>
                </div>
                
                <h3>Star Rating Theo Helpfulness</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Class</th>
                            <th>Mean Rating</th>
                            <th>Std</th>
                            <th>ƒê·∫∑c ƒêi·ªÉm</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Helpful (1)</strong></td>
                            <td class="highlight-negative">3.82 sao</td>
                            <td>1.39</td>
                            <td>C√≥ c·∫£ positive & negative reviews</td>
                        </tr>
                        <tr>
                            <td><strong>Not Helpful (0)</strong></td>
                            <td class="highlight-positive">4.38 sao</td>
                            <td>1.19</td>
                            <td>Thi√™n v·ªÅ 5 sao (positive bias)</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>üí° Lower Rating Reviews C√≥ Xu H∆∞·ªõng H·ªØu √çch H∆°n</h4>
                    <p><strong>Ngh·ªãch l√Ω th√∫ v·ªã:</strong> Reviews ƒë∆∞·ª£c vote helpful c√≥ mean rating TH·∫§P H∆†N (3.82 vs 4.38 sao). T·∫°i sao?</p>
                    <p><strong>Gi·∫£ thuy·∫øt:</strong> Ng∆∞·ªùi d√πng th∆∞·ªùng vote helpful cho critical reviews (1-3 sao) v√¨ ch√∫ng c·∫£nh b√°o v·ªÅ v·∫•n ƒë·ªÅ s·∫£n ph·∫©m. Reviews 5 sao ng·∫Øn g·ªçn "Love it!" √≠t helpful v√¨ thi·∫øu chi ti·∫øt.</p>
                    <p><strong>√ù nghƒ©a:</strong> star_rating l√† feature quan tr·ªçng, nh∆∞ng m·ªëi t∆∞∆°ng quan NG∆Ø·ª¢C v·ªõi helpfulness (lower rating ‚Üí higher helpfulness probability).</p>
                </div>
                
                <h3>3. Ph√¢n T√≠ch Sentiment VADER</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Mean</th>
                            <th>Std</th>
                            <th>Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Compound</strong></td>
                            <td>0.498</td>
                            <td>0.493</td>
                            <td>T·ªïng th·ªÉ t√≠ch c·ª±c (range: -1 to +1)</td>
                        </tr>
                        <tr>
                            <td><strong>Positive</strong></td>
                            <td>0.408</td>
                            <td>0.289</td>
                            <td>40.8% content c√≥ positive sentiment</td>
                        </tr>
                        <tr>
                            <td><strong>Negative</strong></td>
                            <td>0.046</td>
                            <td>0.093</td>
                            <td>Ch·ªâ 4.6% content c√≥ negative sentiment</td>
                        </tr>
                        <tr>
                            <td><strong>Neutral</strong></td>
                            <td>0.547</td>
                            <td>0.310</td>
                            <td>54.7% content neutral (factual descriptions)</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="insight-box">
                    <h4>üí° Sentiment Ph√¢n B·ªë H·ª£p L√Ω</h4>
                    <p><strong>Positive bias nh·∫π:</strong> Mean compound = 0.498 (>0) cho th·∫•y reviews c√≥ xu h∆∞·ªõng t√≠ch c·ª±c, ph√π h·ª£p v·ªõi s·∫£n ph·∫©m Movies & TV (entertainment).</p>
                    <p><strong>Neutral chi·∫øm ∆∞u th·∫ø:</strong> 54.7% content l√† neutral, ch·ª©ng t·ªè VADER ho·∫°t ƒë·ªông t·ªët - kh√¥ng over-detect sentiment ·ªü text m√¥ t·∫£ kh√°ch quan.</p>
                    <p><strong>Feature value:</strong> Sentiment scores b·ªï sung th√¥ng tin ngo√†i star_rating. V√≠ d·ª•: Review 1 sao c√≥ th·ªÉ c√≥ neutral sentiment n·∫øu ch·ªâ m√¥ t·∫£ l·ªói k·ªπ thu·∫≠t (kh√¥ng c·∫£m x√∫c).</p>
                </div>
            </div>
            
            <!-- Text Preprocessing -->
            <div class="section">
                <h2>üî§ Pipeline Ti·ªÅn X·ª≠ L√Ω Text</h2>
                <h3>H√†m clean_text_udf()</h3>
                <div class="code-block">
def clean_text_udf():
    """
    Spark UDF ƒë·ªÉ l√†m s·∫°ch text:
    1. Chuy·ªÉn th√†nh ch·ªØ th∆∞·ªùng
    2. X√≥a HTML tags (<.*?>)
    3. X√≥a URLs (http[s]?://...)
    4. X√≥a ƒë·ªãa ch·ªâ email (\\S+@\\S+)
    5. Thay th·∫ø contractions (don't ‚Üí don t)
    6. Lo·∫°i b·ªè kho·∫£ng tr·∫Øng th·ª´a
    7. X√≥a kho·∫£ng tr·∫Øng ƒë·∫ßu/cu·ªëi
    """
    @udf(returnType=StringType())
    def clean(text):
        if not text:
            return ""
        text = text.lower()
        text = re.sub(r'<.*?>', ' ', text)
        text = re.sub(r'http[s]?://\S+', ' ', text)
        text = re.sub(r'\S+@\S+', ' ', text)
        text = re.sub(r'[^a-z0-9\s]', ' ', text)
        text = re.sub(r'\s+', ' ', text)
        return text.strip()
    return clean
                </div>
                
                <h3>V√≠ D·ª• Chuy·ªÉn ƒê·ªïi</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Text G·ªëc</th>
                            <th>Text ƒê√£ L√†m S·∫°ch</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>I LOVE this product!!! üòç</td>
                            <td>i love this product</td>
                        </tr>
                        <tr>
                            <td>Check out: http://example.com</td>
                            <td>check out</td>
                        </tr>
                        <tr>
                            <td>Contact: support@company.com</td>
                            <td>contact</td>
                        </tr>
                        <tr>
                            <td>&lt;b&gt;Great!&lt;/b&gt; Don't miss it.</td>
                            <td>great don t miss it</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>C√°c Giai ƒêo·∫°n Spark ML Pipeline</h3>
                <div class="code-block">
stages = [
    # Giai ƒëo·∫°n 1: L√†m s·∫°ch text
    SQLTransformer(
        statement="SELECT *, clean_text_udf(review_text) AS clean_text FROM __THIS__"
    ),
    
    # Giai ƒëo·∫°n 2: Tokenize (t√°ch th√†nh t·ª´)
    Tokenizer(inputCol="clean_text", outputCol="tokens"),
    
    # Giai ƒëo·∫°n 3: X√≥a stopwords (the, is, and, v.v.)
    StopWordsRemover(inputCol="tokens", outputCol="filtered_tokens")
]
                </div>
            </div>
            
            <!-- Technical Stack -->
            <div class="section">
                <h2>üõ†Ô∏è Technical Stack & Performance</h2>
                <h3>H·∫° T·∫ßng</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Version/Config</th>
                            <th>M√¥ T·∫£</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Apache Spark</strong></td>
                            <td>3.5.7</td>
                            <td>Distributed data processing engine</td>
                        </tr>
                        <tr>
                            <td><strong>HDFS</strong></td>
                            <td>localhost:9000</td>
                            <td>Distributed file system, replication=3</td>
                        </tr>
                        <tr>
                            <td><strong>Python</strong></td>
                            <td>3.11</td>
                            <td>Via py launcher (Windows)</td>
                        </tr>
                        <tr>
                            <td><strong>Driver Memory</strong></td>
                            <td>6 GB</td>
                            <td>Spark driver process</td>
                        </tr>
                        <tr>
                            <td><strong>Executor Memory</strong></td>
                            <td>4 GB</td>
                            <td>Spark worker processes</td>
                        </tr>
                        <tr>
                            <td><strong>Cores</strong></td>
                            <td>local[4]</td>
                            <td>4 parallel tasks</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Th∆∞ Vi·ªán & Dependencies</h3>
                <div class="code-block">
# Th∆∞ Vi·ªán Python
pyspark==3.5.7           # X·ª≠ l√Ω d·ªØ li·ªáu ph√¢n t√°n
vaderSentiment==3.3.2    # Ph√¢n t√≠ch sentiment
scikit-learn             # ML models (d·ª± ki·∫øn Ng√†y 3)
lightgbm                 # Gradient boosting (d·ª± ki·∫øn Ng√†y 5)
optuna                   # Hyperparameter tuning (d·ª± ki·∫øn Ng√†y 6)
                </div>
                
                <h3>Performance ETL Pipeline</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="number">~1 gi·ªù</span>
                        <span class="label">ETL Time (17.3M)</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">9.4 GB</span>
                        <span class="label">Parquet Output</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">27</span>
                        <span class="label">Partitions (nƒÉm)</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">Snappy</span>
                        <span class="label">Compression</span>
                    </div>
                </div>
                
                <div class="insight-box">
                    <h4>üí° Ghi Ch√∫ T·ªëi ∆Øu Performance</h4>
                    <ul style="margin-left: 20px; color: #856404;">
                        <li><strong>Partitioning theo year/month:</strong> TƒÉng t·ªëc queries c√≥ filter temporal</li>
                        <li><strong>Snappy compression:</strong> Balance gi·ªØa compression ratio v√† t·ªëc ƒë·ªô decompression</li>
                        <li><strong>Metadata integration:</strong> Manual JSON parsing tr√°nh nested struct errors (748K products)</li>
                        <li><strong>Left join:</strong> B·∫£o to√†n t·∫•t c·∫£ 17.3M reviews, null-safe cho products kh√¥ng c√≥ metadata</li>
                        <li><strong>VADER tr√™n driver:</strong> Broadcast lexicon ƒë·ªÉ tr√°nh serialization overhead</li>
                    </ul>
                </div>
            </div>
            
            <!-- Next Steps -->
            <div class="section">
                <h2>üöÄ C√°c B∆∞·ªõc Ti·∫øp Theo - Ng√†y 2</h2>
                <div class="recommendation-box">
                    <h4>üìã C√¥ng Vi·ªác Tu·∫•n - H·∫° T·∫ßng</h4>
                    <ul>
                        <li>T√≠ch h·ª£p text preprocessing v√†o ETL pipeline (clean_text column)</li>
                        <li>Th√™m sentiment scores (compound, pos, neg, neu) v√†o Parquet</li>
                        <li>T·∫°o metadata features: review_length_log, is_long_review, rating_deviation</li>
                        <li>L∆∞u Features V1 dataset v√†o HDFS</li>
                        <li>Test train/test split v·ªõi stratification</li>
                    </ul>
                </div>
                
                <div class="recommendation-box" style="background: #cce5ff; border-color: #004085;">
                    <h4 style="color: #004085;">üî¨ C√¥ng Vi·ªác Thanh - Khoa H·ªçc D·ªØ Li·ªáu</h4>
                    <ul style="color: #004085;">
                        <li>Test TF-IDF pipeline v·ªõi Spark ML (HashingTF + IDF)</li>
                        <li>Th·ª≠ nghi·ªám v·ªõi numFeatures kh√°c nhau (5K, 10K, 20K)</li>
                        <li>Ph√¢n t√≠ch token distribution theo class</li>
                        <li>K·∫øt h·ª£p TF-IDF + metadata features v·ªõi VectorAssembler</li>
                        <li>Chu·∫©n b·ªã cho baseline Logistic Regression (Ng√†y 3)</li>
                    </ul>
                </div>
            </div>
            
            <!-- Key Takeaways -->
            <div class="section">
                <h2>üìå ƒêi·ªÉm Nh·∫•n Quan Tr·ªçng</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="number">‚úÖ</span>
                        <span class="label">HDFS S·∫µn S√†ng</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">‚úÖ</span>
                        <span class="label">ETL Pipeline</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">‚úÖ</span>
                        <span class="label">Metadata Integrated</span>
                    </div>
                    <div class="stat-card">
                        <span class="number">‚úÖ</span>
                        <span class="label">EDA Ho√†n Th√†nh</span>
                    </div>
                </div>
                
                <div class="insight-box">
                    <h4>üí° Nh·ªØng Ph√°t Hi·ªán Quan Tr·ªçng Nh·∫•t</h4>
                    <p><strong>1. Review length l√† signal m·∫°nh nh·∫•t:</strong> Helpful reviews d√†i g·∫•p 4.08 l·∫ßn (97.7 vs 23.9 t·ª´).</p>
                    <p><strong>2. Lower rating reviews helpful h∆°n:</strong> Mean rating 3.82 vs 4.38 - ngh·ªãch l√Ω th√∫ v·ªã!</p>
                    <p><strong>3. Class imbalance 3:1:</strong> V·ª´a ph·∫£i, c√≥ th·ªÉ x·ª≠ l√Ω b·∫±ng class_weight m√† kh√¥ng c·∫ßn SMOTE.</p>
                    <p><strong>4. Sentiment b·ªï sung th√¥ng tin:</strong> VADER compound = 0.498 capture emotional tone ri√™ng bi·ªát v·ªõi rating.</p>
                    <p><strong>5. Metadata integration th√†nh c√¥ng:</strong> 748K products v·ªõi brand/category/price s·∫µn s√†ng cho feature engineering.</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p><strong>D·ª± √Ån D·ª± ƒêo√°n T√≠nh H·ªØu √çch Reviews Amazon</strong></p>
            <p>GitHub Repository: <a href="https://github.com/htuan154/AmazonReviewInsight" target="_blank">github.com/htuan154/AmazonReviewInsight</a></p>
            <p style="margin-top: 10px; opacity: 0.8;">Ng√†y 1 Ho√†n Th√†nh: 26/10/2025</p>
        </footer>
    </div>
</body>
</html>
