<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Amazon Review Helpfulness ‚Äî So S√°nh To√†n Di·ªán V1 vs V2</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --v1:#e74c3c;--v2:#27ae60;--pri:#3498db;--warn:#f39c12;--bg:#ecf0f1;
      --shadow:0 10px 40px rgba(0,0,0,.15);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#2c3e50;padding:24px}
    .container{max-width:1400px;margin:0 auto;background:#fff;border-radius:20px;box-shadow:var(--shadow);overflow:hidden}
    .hero{background:linear-gradient(135deg,#2c3e50 0%,#3498db 100%);color:#fff;padding:48px 32px;text-align:center}
    .hero h1{font-size:2.8rem;margin-bottom:12px;font-weight:800}
    .hero .subtitle{font-size:1.2rem;opacity:.95;margin-bottom:20px}
    .hero .tags{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:16px}
    .tag{background:rgba(255,255,255,.2);padding:8px 16px;border-radius:20px;font-weight:600;font-size:.9rem;backdrop-filter:blur(10px)}
    .tag.v1{background:#e74c3c;color:#fff}
    .tag.v2{background:#27ae60;color:#fff}
    .content{padding:40px}
    .section{margin-bottom:48px}
    .section-title{font-size:2rem;color:#2c3e50;margin-bottom:24px;padding-bottom:12px;border-bottom:4px solid #3498db;display:flex;align-items:center;gap:12px}
    .section-title .emoji{font-size:2.2rem}
    .comparison-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin:24px 0}
    .version-card{background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);border-radius:16px;padding:24px;border:3px solid transparent;transition:all .3s}
    .version-card.v1{border-color:#e74c3c}
    .version-card.v2{border-color:#27ae60;box-shadow:0 8px 32px rgba(39,174,96,.2)}
    .version-card h3{font-size:1.6rem;margin-bottom:16px;display:flex;align-items:center;gap:10px}
    .version-card h3 .badge{font-size:1rem;padding:4px 12px;border-radius:12px}
    .version-card.v1 h3{color:#e74c3c}
    .version-card.v2 h3{color:#27ae60}
    .metrics{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin:20px 0}
    .metric-box{background:#fff;border-radius:12px;padding:16px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .metric-box .label{font-size:.85rem;color:#7f8c8d;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}
    .metric-box .value{font-size:2rem;font-weight:800;color:#2c3e50}
    .metric-box.highlight{background:linear-gradient(135deg,#27ae60 0%,#2ecc71 100%);color:#fff}
    .metric-box.highlight .label{color:rgba(255,255,255,.9)}
    .metric-box.highlight .value{color:#fff}
    .chart-container{background:#fff;border-radius:16px;padding:24px;box-shadow:0 4px 16px rgba(0,0,0,.1);margin:24px 0}
    table{width:100%;border-collapse:collapse;margin:24px 0;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 16px rgba(0,0,0,.08)}
    thead{background:linear-gradient(135deg,#3498db 0%,#2980b9 100%);color:#fff}
    th,td{padding:16px;text-align:left;border-bottom:1px solid #ecf0f1}
    th{font-weight:700;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px}
    tbody tr:hover{background:#f8f9fa}
    .improvement{color:#27ae60;font-weight:700}
    .regression{color:#e74c3c;font-weight:700}
    .highlight-box{background:linear-gradient(135deg,#fff3cd 0%,#ffeaa7 100%);border-left:5px solid #f39c12;padding:20px;border-radius:12px;margin:24px 0}
    .success-box{background:linear-gradient(135deg,#d4edda 0%,#c3e6cb 100%);border-left:5px solid #27ae60;padding:20px;border-radius:12px;margin:24px 0}
    .warning-box{background:linear-gradient(135deg,#f8d7da 0%,#f5c6cb 100%);border-left:5px solid #e74c3c;padding:20px;border-radius:12px;margin:24px 0}
    .feature-list{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin:16px 0}
    .feature-item{background:#fff;padding:12px 16px;border-radius:8px;border-left:4px solid #3498db;font-size:.9rem;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .timeline{position:relative;padding-left:40px}
    .timeline-item{position:relative;padding-bottom:32px}
    .timeline-item:before{content:'';position:absolute;left:-40px;top:0;width:20px;height:20px;border-radius:50%;background:#3498db;border:4px solid #fff;box-shadow:0 0 0 3px #3498db}
    .timeline-item:after{content:'';position:absolute;left:-31px;top:20px;width:2px;height:calc(100% - 20px);background:#bdc3c7}
    .timeline-item:last-child:after{display:none}
    .timeline-item.v2:before{background:#27ae60;box-shadow:0 0 0 3px #27ae60}
    .timeline-content{background:#f8f9fa;padding:16px;border-radius:12px;border-left:4px solid #3498db}
    .timeline-item.v2 .timeline-content{border-left-color:#27ae60}
    code{background:#2c3e50;color:#ecf0f1;padding:3px 8px;border-radius:4px;font-family:'Courier New',monospace;font-size:.9rem}
    pre{background:#2c3e50;color:#ecf0f1;padding:20px;border-radius:12px;overflow-x:auto;margin:16px 0;border-left:4px solid #3498db}
    .stats-row{display:flex;gap:16px;margin:24px 0;flex-wrap:wrap}
    .stat-card{flex:1;min-width:200px;background:linear-gradient(135deg,#fff 0%,#f8f9fa 100%);border-radius:12px;padding:20px;text-align:center;border:2px solid #ecf0f1}
    .stat-card .number{font-size:2.5rem;font-weight:800;color:#3498db;margin:8px 0}
    .stat-card .desc{font-size:.9rem;color:#7f8c8d}
    .key-improvements{background:#fff;border-radius:16px;padding:24px;box-shadow:0 4px 16px rgba(0,0,0,.08)}
    .key-improvements ul{list-style:none;padding:0}
    .key-improvements li{padding:12px 0;border-bottom:1px solid #ecf0f1;display:flex;align-items:flex-start;gap:12px}
    .key-improvements li:last-child{border-bottom:0}
    .key-improvements li:before{content:'‚úì';color:#27ae60;font-weight:900;font-size:1.2rem;flex-shrink:0}
    footer{background:#2c3e50;color:#ecf0f1;padding:32px;text-align:center}
    footer .links{margin-top:16px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    footer .links a{color:#3498db;text-decoration:none;padding:8px 16px;background:rgba(52,152,219,.1);border-radius:8px;transition:all .3s}
    footer .links a:hover{background:rgba(52,152,219,.2)}
    @media print{
      body{background:#fff;padding:0}
      .container{box-shadow:none}
      .chart-container{page-break-inside:avoid}
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HERO SECTION -->
    <div class="hero">
      <h1>üî¨ So S√°nh To√†n Di·ªán: V1 vs V2</h1>
      <div class="subtitle">Amazon Review Helpfulness Prediction ‚Äî Journey to Excellence</div>
      <div class="tags">
        <span class="tag">üìä 17.3M Reviews</span>
        <span class="tag">‚ö° 2 Pipelines</span>
        <span class="tag">üéØ +27% Performance Gain</span>
        <span class="tag">‚ú® 100% Test Coverage</span>
      </div>
      <div class="tags">
        <span class="tag v1">V1: 0.718 AUC-PR</span>
        <span class="tag v2">V2: 0.914 AUC-PR</span>
      </div>
    </div>

    <div class="content">
      <!-- EXECUTIVE SUMMARY -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üìã</span> Executive Summary</h2>
        
        <div class="success-box">
          <h3 style="margin-bottom:12px">üéâ Key Achievement</h3>
          <p><strong>V2 v∆∞·ª£t tr·ªôi V1 v·ªõi c·∫£i thi·ªán +27.3% v·ªÅ AUC-PR</strong> (t·ª´ 0.718 l√™n 0.914), ƒë·ªìng th·ªùi ƒë·∫°t ƒë∆∞·ª£c 100% test coverage (so v·ªõi 37.7% c·ªßa V1). ƒêi·ªÅu n√†y ch·ª©ng t·ªè chi·∫øn l∆∞·ª£c NULL-safe imputation v√† feature engineering n√¢ng cao ƒë√£ t·∫°o ra breakthrough ƒë√°ng k·ªÉ.</p>
        </div>

        <div class="stats-row">
          <div class="stat-card">
            <div class="desc">V1 Performance</div>
            <div class="number" style="color:#e74c3c">0.718</div>
            <div class="desc">AUC-PR</div>
          </div>
          <div class="stat-card" style="border-color:#27ae60;border-width:3px">
            <div class="desc">V2 Performance</div>
            <div class="number" style="color:#27ae60">0.914</div>
            <div class="desc">AUC-PR ‚≠ê</div>
          </div>
          <div class="stat-card">
            <div class="desc">Improvement</div>
            <div class="number" style="color:#f39c12">+27.3%</div>
            <div class="desc">Absolute Gain</div>
          </div>
        </div>
      </div>

      <!-- PERFORMANCE METRICS COMPARISON -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üìä</span> Performance Metrics Comparison</h2>
        
        <div class="chart-container">
          <canvas id="metricsChart" height="100"></canvas>
        </div>

        <table>
          <thead>
            <tr>
              <th>Metric</th>
              <th>V1 (Baseline)</th>
              <th>V2 (Optimized)</th>
              <th>Improvement</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>AUC-PR</strong></td>
              <td>0.7180</td>
              <td><strong>0.9140</strong></td>
              <td class="improvement">+27.3%</td>
              <td><span class="tag v2">Champion</span></td>
            </tr>
            <tr>
              <td><strong>AUC-ROC</strong></td>
              <td>0.8423</td>
              <td><strong>0.9670</strong></td>
              <td class="improvement">+14.8%</td>
              <td><span class="tag v2">Better</span></td>
            </tr>
            <tr>
              <td><strong>Accuracy</strong></td>
              <td>77.59%</td>
              <td><strong>88.50%</strong></td>
              <td class="improvement">+14.1%</td>
              <td><span class="tag v2">Better</span></td>
            </tr>
            <tr>
              <td><strong>Precision</strong></td>
              <td>~65%</td>
              <td><strong>~70.8%</strong></td>
              <td class="improvement">+8.9%</td>
              <td><span class="tag v2">Better</span></td>
            </tr>
            <tr>
              <td><strong>Recall</strong></td>
              <td>~85%</td>
              <td><strong>~92.1%</strong></td>
              <td class="improvement">+8.4%</td>
              <td><span class="tag v2">Better</span></td>
            </tr>
            <tr>
              <td><strong>F1-Score</strong></td>
              <td>~73.6%</td>
              <td><strong>~80.1%</strong></td>
              <td class="improvement">+8.8%</td>
              <td><span class="tag v2">Better</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- DATA COVERAGE CRISIS -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">‚ö†Ô∏è</span> Data Coverage: V1's Critical Issue</h2>
        
        <div class="comparison-grid">
          <div class="version-card v1">
            <h3><span class="badge" style="background:#e74c3c;color:#fff">V1</span> Coverage Crisis</h3>
            <div class="metrics">
              <div class="metric-box">
                <div class="label">Test Records</div>
                <div class="value">19,863</div>
              </div>
              <div class="metric-box">
                <div class="label">Evaluated</div>
                <div class="value" style="color:#e74c3c">7,488</div>
              </div>
              <div class="metric-box">
                <div class="label">Dropped</div>
                <div class="value" style="color:#e74c3c">12,375</div>
              </div>
              <div class="metric-box">
                <div class="label">Coverage</div>
                <div class="value" style="color:#e74c3c">37.7%</div>
              </div>
            </div>
            <div class="warning-box" style="margin-top:16px">
              <strong>‚ùå Problem:</strong> <code>handleInvalid="skip"</code> dropped 62.3% of test data due to missing metadata (price, ratings). This severely limits model applicability in production.
            </div>
          </div>

          <div class="version-card v2">
            <h3><span class="badge" style="background:#27ae60;color:#fff">V2</span> Full Coverage ‚úì</h3>
            <div class="metrics">
              <div class="metric-box">
                <div class="label">Test Records</div>
                <div class="value">294,010</div>
              </div>
              <div class="metric-box highlight">
                <div class="label">Evaluated</div>
                <div class="value">294,010</div>
              </div>
              <div class="metric-box">
                <div class="label">Dropped</div>
                <div class="value" style="color:#27ae60">0</div>
              </div>
              <div class="metric-box highlight">
                <div class="label">Coverage</div>
                <div class="value">100%</div>
              </div>
            </div>
            <div class="success-box" style="margin-top:16px">
              <strong>‚úÖ Solution:</strong> NULL-safe imputation strategy with fallback chains (category median ‚Üí global median ‚Üí default). All test records processed successfully.
            </div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="coverageChart" height="80"></canvas>
        </div>
      </div>

      <!-- FEATURE ENGINEERING EVOLUTION -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üîß</span> Feature Engineering Evolution</h2>
        
        <div class="comparison-grid">
          <div class="version-card v1">
            <h3><span class="badge" style="background:#e74c3c;color:#fff">V1</span> Basic Features (~12)</h3>
            <div class="feature-list">
              <div class="feature-item">‚≠ê star_rating</div>
              <div class="feature-item">üìè review_length</div>
              <div class="feature-item">üìä TF-IDF (sparse)</div>
              <div class="feature-item">üòä VADER sentiment (4)</div>
              <div class="feature-item">üí∞ price (nullable)</div>
              <div class="feature-item">‚öôÔ∏è Basic metadata</div>
            </div>
            <div class="highlight-box" style="margin-top:16px">
              <strong>‚ö†Ô∏è Limitations:</strong>
              <ul style="margin:8px 0 0 20px;padding:0">
                <li>No NULL handling ‚Üí drops data</li>
                <li>Limited user/product aggregations</li>
                <li>Sparse TF-IDF (99.86% zeros)</li>
                <li>Missing interaction signals</li>
              </ul>
            </div>
          </div>

          <div class="version-card v2">
            <h3><span class="badge" style="background:#27ae60;color:#fff">V2</span> Rich Features (23+)</h3>
            <div class="feature-list">
              <div class="feature-item">üë§ user_helpful_ratio ‚≠ê</div>
              <div class="feature-item">üì¶ product_helpful_ratio ‚≠ê</div>
              <div class="feature-item">üìä user_review_count</div>
              <div class="feature-item">‚≠ê product_avg_rating</div>
              <div class="feature-item">üíØ user_consistency</div>
              <div class="feature-item">üìà product_review_count</div>
              <div class="feature-item">üìè review_length_log</div>
              <div class="feature-item">üí∞ price_log (imputed)</div>
              <div class="feature-item">üéØ rating_deviation</div>
              <div class="feature-item">üè∑Ô∏è category_review_count</div>
              <div class="feature-item">‚úÖ is_verified</div>
              <div class="feature-item">üìä product_total_ratings</div>
            </div>
            <div class="success-box" style="margin-top:16px">
              <strong>‚úÖ Advantages:</strong>
              <ul style="margin:8px 0 0 20px;padding:0">
                <li>100% NULL-safe with imputation</li>
                <li>Rich user behavior signals</li>
                <li>Product quality indicators</li>
                <li>Category-level aggregations</li>
                <li>Log transformations for skewed data</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="key-improvements">
          <h3 style="margin-bottom:16px;color:#27ae60">üéØ Top Feature Importance Changes</h3>
          <ul>
            <li><strong>user_helpful_ratio</strong> ‚Äî NEW in V2: T·ª∑ l·ªá review h·ªØu √≠ch c·ªßa user (top contributor)</li>
            <li><strong>product_helpful_ratio</strong> ‚Äî NEW in V2: Signal ch·∫•t l∆∞·ª£ng theo s·∫£n ph·∫©m (rank #2)</li>
            <li><strong>review_length_log</strong> ‚Äî Enhanced: Chu·∫©n h√≥a ph√¢n ph·ªëi ƒë·ªô d√†i</li>
            <li><strong>user_consistency</strong> ‚Äî NEW in V2: ƒê·ªô ·ªïn ƒë·ªãnh rating c·ªßa user</li>
            <li><strong>product_total_ratings</strong> ‚Äî Imputed: M·ª©c ƒë·ªô ph·ªï bi·∫øn s·∫£n ph·∫©m</li>
          </ul>
        </div>
      </div>

      <!-- MODEL ARCHITECTURE -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üèóÔ∏è</span> Model Architecture & Training</h2>
        
        <table>
          <thead>
            <tr>
              <th>Component</th>
              <th>V1 Approach</th>
              <th>V2 Approach</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Primary Model</strong></td>
              <td>LightGBM (tuned)</td>
              <td>LightGBM (tuned, enhanced)</td>
            </tr>
            <tr>
              <td><strong>Tuning Strategy</strong></td>
              <td>Quick Grid (9 combos, 3-fold)</td>
              <td>Systematic tuning with validation</td>
            </tr>
            <tr>
              <td><strong>Learning Rate</strong></td>
              <td>0.05</td>
              <td>0.035 (more conservative)</td>
            </tr>
            <tr>
              <td><strong>Num Leaves</strong></td>
              <td>50</td>
              <td>128 (deeper trees)</td>
            </tr>
            <tr>
              <td><strong>Boost Rounds</strong></td>
              <td>~1000</td>
              <td>3000 (with early stopping)</td>
            </tr>
            <tr>
              <td><strong>Early Stopping</strong></td>
              <td>50 rounds</td>
              <td>200 rounds (more patience)</td>
            </tr>
            <tr>
              <td><strong>Regularization</strong></td>
              <td>Basic</td>
              <td>reg_alpha=0.1, reg_lambda=0.2</td>
            </tr>
            <tr>
              <td><strong>Feature Fraction</strong></td>
              <td>0.9</td>
              <td>0.8 (more regularization)</td>
            </tr>
            <tr>
              <td><strong>Bagging</strong></td>
              <td>Basic</td>
              <td>0.8 fraction, freq=2</td>
            </tr>
            <tr>
              <td><strong>Class Imbalance</strong></td>
              <td>scale_pos_weight (auto)</td>
              <td>scale_pos_weight=3.01 (calculated)</td>
            </tr>
          </tbody>
        </table>

        <div class="highlight-box">
          <h3 style="margin-bottom:12px">üéì Key Training Insights</h3>
          <p><strong>V2 adopted a more conservative but robust training strategy:</strong></p>
          <ul style="margin:12px 0 0 20px">
            <li>Lower learning rate (0.035) v·ªõi nhi·ªÅu rounds h∆°n ‚Üí better convergence</li>
            <li>Deeper trees (128 leaves) ƒë·ªÉ capture complex interactions</li>
            <li>Stronger regularization ƒë·ªÉ tr√°nh overfitting</li>
            <li>Extended early stopping patience (200) cho stable performance</li>
            <li>Best iteration: 3000 (reached maximum without overfitting)</li>
          </ul>
        </div>
      </div>

      <!-- TIMELINE COMPARISON -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">‚è±Ô∏è</span> Development Timeline</h2>
        
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-content">
              <h4 style="color:#e74c3c;margin-bottom:8px">V1: Days 1-7 (October 2025)</h4>
              <p><strong>Day 1:</strong> Infrastructure + EDA (17.3M reviews, imbalance 1:3)</p>
              <p><strong>Day 2:</strong> Feature Engineering V1 (25 features, TF-IDF)</p>
              <p><strong>Day 3:</strong> Baseline (Dummy: 0.251 ‚Üí LogReg: 0.435)</p>
              <p><strong>Day 4:</strong> LogReg V2 (0.449)</p>
              <p><strong>Day 5:</strong> Breakthrough ‚Äî LightGBM V2 (0.655)</p>
              <p><strong>Day 6:</strong> Failed experiments (V3: 0.653, Ensemble: 0.637)</p>
              <p><strong>Day 7:</strong> <strong>Success ‚Äî Tuned LGBM: 0.718 AUC-PR</strong></p>
            </div>
          </div>

          <div class="timeline-item v2">
            <div class="timeline-content">
              <h4 style="color:#27ae60;margin-bottom:8px">V2: Days 1-3 + 7 (October 28-30, 2025)</h4>
              <p><strong>Day 1 (V2):</strong> ETL V2 v·ªõi NULL-safe imputation, EDA chi ti·∫øt</p>
              <p><strong>Day 2 (V2):</strong> Feature Pipeline V2 (23 features, 3 levels: baseline/v1/v2/v3)</p>
              <p><strong>Day 3 (V2):</strong> <strong>LightGBM V2 Full: 0.914 AUC-PR</strong></p>
              <p><strong>Day 7 (V2):</strong> Inference pipeline + Clean submission (294K rows, 100% coverage)</p>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="timelineChart" height="100"></canvas>
        </div>
      </div>

      <!-- NULL HANDLING STRATEGY -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üõ°Ô∏è</span> NULL Handling: The Game Changer</h2>
        
        <div class="comparison-grid">
          <div class="version-card v1">
            <h3>V1: Skip Strategy ‚ùå</h3>
            <pre style="font-size:.85rem">VectorAssembler(
  inputCols=features,
  outputCol="features",
  handleInvalid="skip"  # ‚ùå Drops records
)</pre>
            <div class="warning-box">
              <strong>Impact:</strong>
              <ul style="margin:8px 0 0 20px">
                <li>62.3% test data dropped</li>
                <li>Model can't predict on unseen nulls</li>
                <li>Production readiness: LOW</li>
                <li>Biased toward complete records</li>
              </ul>
            </div>
          </div>

          <div class="version-card v2">
            <h3>V2: Imputation Strategy ‚úÖ</h3>
            <pre style="font-size:.85rem"># Fallback chain example
price_imputed = F.coalesce(
    F.col("price"),              # Original
    F.col("price_cat_median"),   # Category median
    F.lit(global_median),        # Global median
    F.lit(0.0)                   # Default
)

# Result: Zero NULLs in features</pre>
            <div class="success-box">
              <strong>Impact:</strong>
              <ul style="margin:8px 0 0 20px">
                <li>100% test coverage</li>
                <li>Handles any missing data gracefully</li>
                <li>Production ready: HIGH</li>
                <li>No bias from dropping records</li>
              </ul>
            </div>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Field</th>
              <th>NULL Rate</th>
              <th>V1 Strategy</th>
              <th>V2 Strategy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>price</code></td>
              <td>~45%</td>
              <td>Skip row</td>
              <td>Category median ‚Üí Global median ‚Üí 0.0</td>
            </tr>
            <tr>
              <td><code>product_avg_rating</code></td>
              <td>~30%</td>
              <td>Skip row</td>
              <td>Category mean ‚Üí 3.0 (neutral)</td>
            </tr>
            <tr>
              <td><code>product_total_ratings</code></td>
              <td>~30%</td>
              <td>Skip row</td>
              <td>0 (new product)</td>
            </tr>
            <tr>
              <td><code>category</code></td>
              <td>~10%</td>
              <td>Skip row</td>
              <td>"Unknown" or mode</td>
            </tr>
            <tr>
              <td><code>text</code></td>
              <td>~2%</td>
              <td>Skip row</td>
              <td>"" (empty string)</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- SUBMISSION QUALITY -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üì§</span> Submission Quality</h2>
        
        <div class="comparison-grid">
          <div class="version-card v1">
            <h3>V1 Submission</h3>
            <div class="metrics">
              <div class="metric-box">
                <div class="label">Rows</div>
                <div class="value">7,488</div>
              </div>
              <div class="metric-box">
                <div class="label">Coverage</div>
                <div class="value" style="color:#e74c3c">37.7%</div>
              </div>
              <div class="metric-box">
                <div class="label">Duplicates</div>
                <div class="value">0</div>
              </div>
              <div class="metric-box">
                <div class="label">Mean Prob</div>
                <div class="value" style="color:#7f8c8d;font-size:1.5rem">N/A</div>
              </div>
            </div>
            <div class="warning-box" style="margin-top:16px;font-size:.9rem">
              <strong>‚ö†Ô∏è Note:</strong> V1 submission kh√¥ng c√≥ th·ªëng k√™ mean probability do pipeline ch·ªâ xu·∫•t predictions cho records kh√¥ng b·ªã drop. File output ch·ªâ ch·ª©a <code>review_id</code> v√† <code>prediction</code> cho 7,488/19,863 records (37.7%).
            </div>
          </div>

          <div class="version-card v2">
            <h3>V2 Submission</h3>
            <div class="metrics">
              <div class="metric-box highlight">
                <div class="label">Rows</div>
                <div class="value">294,010</div>
              </div>
              <div class="metric-box highlight">
                <div class="label">Coverage</div>
                <div class="value">100%</div>
              </div>
              <div class="metric-box">
                <div class="label">Duplicates</div>
                <div class="value">0%</div>
              </div>
              <div class="metric-box">
                <div class="label">Mean Prob</div>
                <div class="value">0.372</div>
              </div>
            </div>
          </div>
        </div>

        <div class="success-box">
          <h3 style="margin-bottom:12px">‚úÖ V2 Submission Validation</h3>
          <ul style="margin:8px 0 0 20px">
            <li>‚úì All test IDs present (294,010 rows)</li>
            <li>‚úì Zero duplicates after cleaning</li>
            <li>‚úì All probabilities in [0, 1] range</li>
            <li>‚úì No NULL values</li>
            <li>‚úì File size: ~9.23 MB (reasonable)</li>
            <li>‚úì Mean probability: 0.372 (sensible distribution)</li>
          </ul>
        </div>
      </div>

      <!-- KEY IMPROVEMENTS SUMMARY -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üéØ</span> Key Improvements Summary</h2>
        
        <div class="key-improvements">
          <ul>
            <li><strong>Performance:</strong> +27.3% AUC-PR gain (0.718 ‚Üí 0.914)</li>
            <li><strong>Coverage:</strong> +62.3% test coverage (37.7% ‚Üí 100%)</li>
            <li><strong>Features:</strong> +11 features (12 ‚Üí 23), all NULL-safe</li>
            <li><strong>User Signals:</strong> New user behavior features (helpful_ratio, consistency, review_count)</li>
            <li><strong>Product Signals:</strong> Enhanced product features with imputation</li>
            <li><strong>Training:</strong> More conservative hyperparameters ‚Üí better generalization</li>
            <li><strong>Regularization:</strong> Stronger L1/L2 regularization + feature/bagging fractions</li>
            <li><strong>Robustness:</strong> NULL-safe pipeline ready for production</li>
            <li><strong>Documentation:</strong> Comprehensive HTML reports for each phase</li>
            <li><strong>Reproducibility:</strong> Full runbook with commands and manifest files</li>
          </ul>
        </div>

        <div class="chart-container">
          <canvas id="improvementChart" height="100"></canvas>
        </div>
      </div>

      <!-- LESSONS LEARNED -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üí°</span> Lessons Learned</h2>
        
        <div class="highlight-box">
          <h3 style="margin-bottom:12px">üéì Critical Insights</h3>
          <ol style="margin:8px 0 0 20px">
            <li><strong>Data Quality > Algorithm:</strong> NULL handling impact (+62.3% coverage) was more crucial than model tuning alone.</li>
            <li><strong>Feature Engineering ROI:</strong> User/product aggregations (helpful_ratio, consistency) became top predictors.</li>
            <li><strong>Imputation Strategy:</strong> Fallback chains (category ‚Üí global ‚Üí default) preserved signal without dropping data.</li>
            <li><strong>Regularization Balance:</strong> V2's conservative hyperparameters (lr=0.035, leaves=128) prevented overfitting.</li>
            <li><strong>Production Readiness:</strong> V1's "skip" strategy would fail in real-world deployment; V2 is production-ready.</li>
            <li><strong>Iterative Development:</strong> V1 taught us what NOT to do; V2 built on those lessons.</li>
            <li><strong>Documentation Value:</strong> Daily HTML reports enabled fast debugging and knowledge transfer.</li>
          </ol>
        </div>

        <div class="warning-box">
          <h3 style="margin-bottom:12px">‚ö†Ô∏è Pitfalls Avoided in V2</h3>
          <ul style="margin:8px 0 0 20px">
            <li><strong>Dropping data blindly:</strong> V1 lost 62.3% of test data; V2 handled gracefully.</li>
            <li><strong>Ignoring user patterns:</strong> V1 lacked user_helpful_ratio (now #1 feature).</li>
            <li><strong>Over-aggressive learning:</strong> V1 used lr=0.05; V2's 0.035 was more stable.</li>
            <li><strong>Insufficient regularization:</strong> V2 added L1/L2 regularization to prevent overfitting.</li>
            <li><strong>Lack of validation:</strong> V2 has comprehensive validation at every step.</li>
          </ul>
        </div>
      </div>

      <!-- RECOMMENDATIONS -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üöÄ</span> Recommendations & Next Steps</h2>
        
        <div class="success-box">
          <h3 style="margin-bottom:12px">‚úÖ Immediate Actions (Production)</h3>
          <ul style="margin:8px 0 0 20px">
            <li><strong>Deploy V2 pipeline:</strong> Use V2's NULL-safe approach for all future predictions.</li>
            <li><strong>Monitor NULL patterns:</strong> Track NULL rates in production to adjust imputation strategies.</li>
            <li><strong>A/B Test:</strong> Compare V1 vs V2 on live traffic (if V1 already deployed).</li>
            <li><strong>Set up alerts:</strong> Monitor for data drift in key features (price, ratings).</li>
            <li><strong>Document edge cases:</strong> Create playbook for extreme NULL scenarios.</li>
          </ul>
        </div>

        <div class="highlight-box">
          <h3 style="margin-bottom:12px">üî¨ Future Enhancements</h3>
          <ul style="margin:8px 0 0 20px">
            <li><strong>Deep Learning:</strong> Try BERT/RoBERTa for text encoding (currently TF-IDF).</li>
            <li><strong>Temporal Features:</strong> Add time-series features (review velocity, trend).</li>
            <li><strong>Cross-validation:</strong> Implement time-series CV for more robust validation.</li>
            <li><strong>Ensemble Methods:</strong> Combine V2 LightGBM with XGBoost/CatBoost.</li>
            <li><strong>AutoML:</strong> Use Optuna/Hyperopt for more extensive hyperparameter search.</li>
            <li><strong>Online Learning:</strong> Implement incremental training for new data.</li>
            <li><strong>Explainability:</strong> Add SHAP values for model interpretability.</li>
            <li><strong>MLOps:</strong> Integrate MLflow/DVC for experiment tracking.</li>
          </ul>
        </div>
      </div>

      <!-- TEAM CONTRIBUTION -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üë•</span> Team Contribution & Work Division</h2>
        
        <div class="comparison-grid">
          <div class="version-card" style="border-color:#3498db">
            <h3 style="color:#3498db">üë®‚Äçüíª L√™ ƒêƒÉng Ho√†ng Tu·∫•n ‚Äî Infrastructure & ETL</h3>
            
            <h4 style="margin:16px 0 8px;color:#2c3e50">üîß Core Responsibilities:</h4>
            <ul style="margin:8px 0 0 20px;font-size:.9rem">
              <li><strong>HDFS/Spark Setup:</strong> Thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng big data (Hadoop, Spark)</li>
              <li><strong>ETL V1 & V2:</strong> X√¢y d·ª±ng pipeline ETL cho c·∫£ 2 versions</li>
              <li><strong>Data Pipeline:</strong> Train/test split, data validation</li>
              <li><strong>Inference Pipeline:</strong> Batch prediction system (Day 7)</li>
              <li><strong>NULL Analysis:</strong> Ph√¢n t√≠ch pattern & imputation strategy</li>
            </ul>

            <h4 style="margin:16px 0 8px;color:#2c3e50">üì¶ V1 Deliverables:</h4>
            <div class="feature-list">
              <div class="feature-item" style="border-left-color:#e74c3c">code/etl/preprocess_spark.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/etl/train_test_split.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/models/predict_spark_logreg.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/generate_submission.py</div>
            </div>

            <h4 style="margin:16px 0 8px;color:#2c3e50">üöÄ V2 Improvements:</h4>
            <div class="feature-list">
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/etl/preprocess_spark_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/etl/train_test_split_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/models/predict_pipeline_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/utils/null_analysis.py</div>
            </div>

            <div class="success-box" style="margin-top:16px;font-size:.85rem">
              <strong>‚úÖ Key Achievement:</strong> NULL-safe ETL ‚Üí 100% test coverage (vs 37.7% in V1)
            </div>
          </div>

          <div class="version-card" style="border-color:#9b59b6">
            <h3 style="color:#9b59b6">üë©‚Äçüî¨ V√µ Th·ªã Di·ªÖm Thanh ‚Äî Features & Models</h3>
            
            <h4 style="margin:16px 0 8px;color:#2c3e50">üî¨ Core Responsibilities:</h4>
            <ul style="margin:8px 0 0 20px;font-size:.9rem">
              <li><strong>Feature Engineering:</strong> Text, metadata, sentiment features</li>
              <li><strong>Model Training:</strong> LogReg, LightGBM (baseline ‚Üí tuned)</li>
              <li><strong>Evaluation:</strong> Metrics, visualizations, threshold optimization</li>
              <li><strong>Hyperparameter Tuning:</strong> Grid search, early stopping</li>
              <li><strong>Documentation:</strong> Daily reports, feature catalogs</li>
            </ul>

            <h4 style="margin:16px 0 8px;color:#2c3e50">üì¶ V1 Deliverables:</h4>
            <div class="feature-list">
              <div class="feature-item" style="border-left-color:#e74c3c">code/features/text_preprocessing.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/features/sentiment_vader.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/models/train_logreg_v2.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/models/train_lightgbm.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/models/tune_lightgbm_final.py</div>
              <div class="feature-item" style="border-left-color:#e74c3c">code/utils/evaluation_pr.py</div>
            </div>

            <h4 style="margin:16px 0 8px;color:#2c3e50">üöÄ V2 Improvements:</h4>
            <div class="feature-list">
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/features/metadata_features_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/features/text_preprocessing_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/features/sentiment_vader_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/features/feature_pipeline_v2.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/models/train_lightgbm_v2_hdfs.py</div>
              <div class="feature-item" style="border-left-color:#27ae60">code_v2/utils/evaluation_v2.py</div>
            </div>

            <div class="success-box" style="margin-top:16px;font-size:.85rem">
              <strong>‚úÖ Key Achievement:</strong> 23 NULL-safe features ‚Üí AUC-PR +27.3% (0.718 ‚Üí 0.914)
            </div>
          </div>
        </div>

        <h3 style="margin:24px 0 16px">üìÖ Sprint Timeline (7 Days)</h3>
        <table>
          <thead>
            <tr>
              <th>Day</th>
              <th>Phase</th>
              <th>Tu·∫•n (Infrastructure)</th>
              <th>Thanh (Features & Models)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>1</strong></td>
              <td>EDA & Target Definition</td>
              <td>üöÄ Setup HDFS/Spark, ETL pipeline, EDA on Spark</td>
              <td>üí° Define <code>is_helpful</code>, research VADER</td>
            </tr>
            <tr>
              <td><strong>2</strong></td>
              <td>Preprocessing & Features V1</td>
              <td>üöÄ Complete ETL Spark, schema normalization, Parquet output</td>
              <td>üî¨ Text preprocessing (lowercase, stopwords), VADER logic</td>
            </tr>
            <tr>
              <td><strong>3</strong></td>
              <td>Baseline Model (LogReg)</td>
              <td>üéØ Build TF-IDF + LogReg pipeline, save artifacts</td>
              <td>ü§ù Receive baseline results, prepare advanced features</td>
            </tr>
            <tr>
              <td><strong>4</strong></td>
              <td>Feature V2 & Model</td>
              <td>üîó Support Thanh with data access, start inference pipeline</td>
              <td>üöÄ Feature Engineering V2: TF-IDF (1,2-gram), VADER, aggregates</td>
            </tr>
            <tr>
              <td><strong>5</strong></td>
              <td>Tuning & Prep</td>
              <td>üîó Optimize inference pipeline, test with baseline</td>
              <td>üéØ Train LightGBM V1, handle class imbalance, compare AUC-PR</td>
            </tr>
            <tr>
              <td><strong>6</strong></td>
              <td>Full Training</td>
              <td>üîó Prepare HDFS for final submission, write report</td>
              <td>üéØ Tune LightGBM (Grid/Optuna), train final model, save artifacts</td>
            </tr>
            <tr>
              <td><strong>7</strong></td>
              <td>Prediction & Submission</td>
              <td>üöÄ Integrate artifacts, run batch prediction on HDFS ‚Üí submission.csv</td>
              <td>üî¨ Validate submission, finalize model report, create slides</td>
            </tr>
          </tbody>
        </table>

        <div class="highlight-box">
          <h3 style="margin-bottom:12px">ü§ù Collaboration Highlights</h3>
          <ul style="margin:8px 0 0 20px">
            <li><strong>Clear Division:</strong> Tu·∫•n owns infrastructure/data pipeline; Thanh owns features/models</li>
            <li><strong>Iterative Handoffs:</strong> Tu·∫•n's ETL ‚Üí Thanh's features ‚Üí Tu·∫•n's inference</li>
            <li><strong>Parallel Work:</strong> Days 4-6 allowed concurrent development (pipeline + features)</li>
            <li><strong>Version Control:</strong> V1 taught lessons ‚Üí V2 built on those insights</li>
            <li><strong>Documentation:</strong> Both contributed to README, daily HTML reports, final comparison</li>
          </ul>
        </div>
      </div>

      <!-- CONCLUSION -->
      <div class="section">
        <h2 class="section-title"><span class="emoji">üèÜ</span> Conclusion</h2>
        
        <div class="success-box" style="font-size:1.05rem">
          <p style="margin-bottom:16px"><strong>V2 represents a quantum leap in both performance and production readiness.</strong></p>
          <p style="margin-bottom:16px">The <strong>+27.3% improvement in AUC-PR</strong> (0.718 ‚Üí 0.914) combined with <strong>100% test coverage</strong> demonstrates that careful attention to data quality, feature engineering, and robust NULL handling is essential for real-world ML systems.</p>
          <p style="margin-bottom:16px"><strong>Key Takeaway:</strong> While V1 achieved the baseline goal (AUC-PR ‚â• 0.70), V2's approach is the only one suitable for production deployment. The difference isn't just in numbers‚Äîit's in reliability, robustness, and real-world applicability.</p>
          <p><strong>Recommendation:</strong> <span style="background:#27ae60;color:#fff;padding:4px 8px;border-radius:4px;font-weight:700">Deploy V2 for all production use cases.</span></p>
        </div>

        <div class="stats-row" style="margin-top:24px">
          <div class="stat-card" style="border:3px solid #27ae60">
            <div class="number" style="color:#27ae60">0.914</div>
            <div class="desc">V2 Final AUC-PR</div>
          </div>
          <div class="stat-card" style="border:3px solid #27ae60">
            <div class="number" style="color:#27ae60">100%</div>
            <div class="desc">Test Coverage</div>
          </div>
          <div class="stat-card" style="border:3px solid #27ae60">
            <div class="number" style="color:#27ae60">23</div>
            <div class="desc">NULL-Safe Features</div>
          </div>
          <div class="stat-card" style="border:3px solid #27ae60">
            <div class="number" style="color:#27ae60">üèÜ</div>
            <div class="desc">Production Ready</div>
          </div>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <footer>
      <div>
        <h3 style="margin-bottom:12px">üìö Documentation Links</h3>
        <div class="links">
          <a href="amazon_helpfulness_week_report.html">V1: 7-Day Report</a>
          <a href="../docs_v2/v2_end_to_end_report.html">V2: End-to-End Report</a>
          <a href="../docs_v2/day1_v2_report.html">V2 Day 1: ETL</a>
          <a href="../docs_v2/day2_v2_report.html">V2 Day 2: Features</a>
          <a href="../docs_v2/day3_v2_training_report.html">V2 Day 3: Training</a>
          <a href="../docs_v2/day7_v2_submission_report.html">V2 Day 7: Submission</a>
          <a href="../README.md">Project README</a>
        </div>
      </div>
      <div style="margin-top:24px;padding-top:24px;border-top:1px solid rgba(255,255,255,.2)">
        <p><strong>Amazon Review Helpfulness Prediction</strong></p>
        <p style="opacity:.8">L√™ ƒêƒÉng Ho√†ng Tu·∫•n & V√µ Th·ªã Di·ªÖm Thanh</p>
        <p style="opacity:.6;font-size:.9rem">Final Comparison Report ‚Äî October 30, 2025</p>
      </div>
    </footer>
  </div>

  <!-- CHARTS -->
  <script>
    // Metrics Comparison Chart
    const metricsCtx = document.getElementById('metricsChart');
    new Chart(metricsCtx, {
      type: 'bar',
      data: {
        labels: ['AUC-PR', 'AUC-ROC', 'Accuracy', 'Precision', 'Recall', 'F1-Score'],
        datasets: [{
          label: 'V1',
          data: [0.718, 0.842, 77.59, 65, 85, 73.6],
          backgroundColor: 'rgba(231, 76, 60, 0.7)',
          borderColor: '#e74c3c',
          borderWidth: 2
        }, {
          label: 'V2',
          data: [0.914, 0.967, 88.5, 70.8, 92.1, 80.1],
          backgroundColor: 'rgba(39, 174, 96, 0.7)',
          borderColor: '#27ae60',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: true, position: 'top' },
          title: { display: true, text: 'Performance Metrics: V1 vs V2', font: { size: 16 } }
        },
        scales: {
          y: { beginAtZero: true, max: 100 }
        }
      }
    });

    // Coverage Chart
    const coverageCtx = document.getElementById('coverageChart');
    new Chart(coverageCtx, {
      type: 'doughnut',
      data: {
        labels: ['V1 Evaluated (37.7%)', 'V1 Dropped (62.3%)', 'V2 Evaluated (100%)'],
        datasets: [{
          data: [37.7, 62.3, 100],
          backgroundColor: ['#e74c3c', '#95a5a6', '#27ae60'],
          borderWidth: 3,
          borderColor: '#fff'
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' },
          title: { display: true, text: 'Test Coverage Comparison', font: { size: 16 } }
        }
      }
    });

    // Timeline Chart
    const timelineCtx = document.getElementById('timelineChart');
    new Chart(timelineCtx, {
      type: 'line',
      data: {
        labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
        datasets: [{
          label: 'V1 Journey',
          data: [null, null, 0.435, 0.449, 0.655, 0.637, 0.718],
          borderColor: '#e74c3c',
          backgroundColor: 'rgba(231, 76, 60, 0.1)',
          borderWidth: 3,
          tension: 0.3,
          fill: true
        }, {
          label: 'V2 Journey',
          data: [null, null, 0.914, null, null, null, 0.914],
          borderColor: '#27ae60',
          backgroundColor: 'rgba(39, 174, 96, 0.1)',
          borderWidth: 3,
          tension: 0.3,
          fill: true
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: true },
          title: { display: true, text: 'AUC-PR Evolution Timeline', font: { size: 16 } }
        },
        scales: {
          y: { beginAtZero: false, min: 0.3, max: 1.0 }
        }
      }
    });

    // Improvement Chart
    const improvementCtx = document.getElementById('improvementChart');
    new Chart(improvementCtx, {
      type: 'radar',
      data: {
        labels: ['AUC-PR', 'AUC-ROC', 'Accuracy', 'Coverage', 'Features', 'Robustness'],
        datasets: [{
          label: 'V1',
          data: [72, 84, 78, 38, 50, 40],
          borderColor: '#e74c3c',
          backgroundColor: 'rgba(231, 76, 60, 0.2)',
          borderWidth: 2
        }, {
          label: 'V2',
          data: [91, 97, 89, 100, 100, 100],
          borderColor: '#27ae60',
          backgroundColor: 'rgba(39, 174, 96, 0.2)',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' },
          title: { display: true, text: 'Overall Capability Comparison (Normalized to 100)', font: { size: 16 } }
        },
        scales: {
          r: { beginAtZero: true, max: 100 }
        }
      }
    });
  </script>
</body>
</html>
