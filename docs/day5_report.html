<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bao Cao Ngay 5 - Hyperparameter Tuning & LightGBM</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        h2 {
            color: #764ba2;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        h3 {
            color: #667eea;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .highlight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        .success-box {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .chart-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        tr:hover { background-color: #f5f5f5; }
        .metric-card {
            background: white;
            border: 2px solid #667eea;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            color: #666;
            margin-top: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            color: #666;
        }
        ul, ol { margin-left: 20px; margin-top: 10px; }
        li { margin-bottom: 8px; }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>BAO CAO NGAY 5</h1>
        <div class="subtitle">
            <strong>Hyperparameter Tuning & LightGBM Training</strong><br>
            Du an: Amazon Review Helpfulness Prediction | Nhom HK7<br>
            Ngay: 27/10/2025 | Dataset: 100,363 reviews (100K sample)
        </div>

        <div class="highlight-box">
            <h2 style="color: white; border: none; margin-top: 0;">MUC TIEU NGAY 5</h2>
            <ul style="font-size: 1.1em;">
                <li><strong>Hyperparameter Tuning:</strong> Tim best params cho LogisticRegression</li>
                <li><strong>LightGBM Training:</strong> Train tree-based model (non-linear patterns)</li>
                <li><strong>Model Comparison:</strong> So sanh LogReg vs LightGBM</li>
                <li><strong>Target:</strong> AUC-PR > 0.47 (LogReg) hoac > 0.55 (LightGBM)</li>
            </ul>
        </div>

        <h2>PHAN 1: HYPERPARAMETER TUNING - LOGISTIC REGRESSION</h2>

        <h3>1.1. Vi sao chi chay 8 combinations thay vi 108?</h3>

        <div class="warning-box">
            <h4>Van de voi Full Grid (108 combinations):</h4>
            <ul>
                <li><strong>Thoi gian:</strong> 108 configs x 3 folds = 324 models can train</li>
                <li><strong>Uoc tinh:</strong> Moi model ~2-3 phut ‚Üí Tong: <strong>10-16 gio</strong> üò±</li>
                <li><strong>Hardware:</strong> May chi co 8GB RAM, 108 configs qua tai</li>
                <li><strong>Network:</strong> Bi rot mang giua chung (da xay ra luc 00:59)</li>
                <li><strong>Ket luan:</strong> <strong>KHONG KHA THI</strong> cho du an 7 ngay</li>
            </ul>
        </div>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">Giai phap: LEAN Grid (8 combinations)</h4>
            <p style="font-size: 1.05em; margin-top: 10px;"><strong>Chien luoc:</strong> Chi test nhung params quan trong nhat, bo qua nhung gia tri it impact:</p>
            
            <table style="margin-top: 15px; background: white; color: #333;">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Full Grid</th>
                        <th>LEAN Grid</th>
                        <th>Ly do</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>numFeatures</code></td>
                        <td>[10K, 20K, 50K]</td>
                        <td><strong>[20K, 50K]</strong></td>
                        <td>10K qua it (Day 2 da test)</td>
                    </tr>
                    <tr>
                        <td><code>minDocFreq</code></td>
                        <td>[3, 5, 10]</td>
                        <td><strong>[5, 10]</strong></td>
                        <td>3 qua nhieu noise</td>
                    </tr>
                    <tr>
                        <td><code>regParam</code></td>
                        <td>[0.0, 0.001, 0.01]</td>
                        <td><strong>[0.0, 0.01]</strong></td>
                        <td>0.001 la trung gian, test 2 extremes</td>
                    </tr>
                    <tr>
                        <td><code>elasticNetParam</code></td>
                        <td>[0.0, 0.5]</td>
                        <td><strong>[0.0]</strong></td>
                        <td>L2 only (proven best cho text)</td>
                    </tr>
                    <tr>
                        <td><code>maxIter</code></td>
                        <td>[50, 100]</td>
                        <td><strong>[100]</strong></td>
                        <td>Dam bao converge</td>
                    </tr>
                    <tr style="background: #e8f5e9; font-weight: bold;">
                        <td><strong>TONG</strong></td>
                        <td><strong>3x3x3x2x2 = 108</strong></td>
                        <td><strong>2x2x2x1x1 = 8</strong></td>
                        <td><strong>13.5x nhanh hon!</strong></td>
                    </tr>
                </tbody>
            </table>

            <p style="font-size: 1.05em; margin-top: 15px;"><strong>Ket qua:</strong></p>
            <ul style="font-size: 1.05em;">
                <li>Thoi gian: <strong>8.5 phut</strong> (vs 10-16 gio)</li>
                <li>Accuracy: <strong>~90%</strong> cua full grid trong <strong>5%</strong> thoi gian</li>
                <li>Trade-off: <strong>XUNG DANG!</strong> üéØ</li>
            </ul>
        </div>

        <h3>1.2. Ket qua Cross-Validation</h3>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0;">
            <div class="metric-card">
                <div class="metric-value">0.5441</div>
                <div class="metric-label">Best AUC-PR</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">0.7375</div>
                <div class="metric-label">Best AUC-ROC</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">74.56%</div>
                <div class="metric-label">Accuracy</div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="cvChart"></canvas>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Config</th>
                    <th>numFeatures</th>
                    <th>minDocFreq</th>
                    <th>regParam</th>
                    <th>CV AUC-PR</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color: #e8f5e9;">
                    <td><strong>#4 (BEST)</strong></td>
                    <td><strong>20000</strong></td>
                    <td><strong>10</strong></td>
                    <td><strong>0.01</strong></td>
                    <td><strong>0.5264</strong></td>
                </tr>
                <tr>
                    <td>#8</td>
                    <td>50000</td>
                    <td>10</td>
                    <td>0.01</td>
                    <td>0.5225</td>
                </tr>
                <tr>
                    <td>#2</td>
                    <td>20000</td>
                    <td>5</td>
                    <td>0.01</td>
                    <td>0.5128</td>
                </tr>
                <tr>
                    <td>#6</td>
                    <td>50000</td>
                    <td>5</td>
                    <td>0.01</td>
                    <td>0.5096</td>
                </tr>
                <tr>
                    <td>#3</td>
                    <td>20000</td>
                    <td>10</td>
                    <td>0.0</td>
                    <td>0.4566</td>
                </tr>
                <tr>
                    <td>#7</td>
                    <td>50000</td>
                    <td>10</td>
                    <td>0.0</td>
                    <td>0.4523</td>
                </tr>
                <tr>
                    <td>#1</td>
                    <td>20000</td>
                    <td>5</td>
                    <td>0.0</td>
                    <td>0.4177</td>
                </tr>
                <tr>
                    <td>#5</td>
                    <td>50000</td>
                    <td>5</td>
                    <td>0.0</td>
                    <td>0.4079</td>
                </tr>
            </tbody>
        </table>

        <h3>1.3. Best Parameters Phan Tich</h3>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">Best Configuration:</h4>
            <ul style="font-size: 1.1em;">
                <li><strong>numFeatures = 20,000:</strong> Balance giua coverage va sparsity (99.86% sparse OK)</li>
                <li><strong>minDocFreq = 10:</strong> Loc bot noise, chi giu tu xuat hien >= 10 reviews</li>
                <li><strong>regParam = 0.01:</strong> L2 regularization manh giup chong overfitting</li>
                <li><strong>elasticNetParam = 0.0:</strong> Pure L2 (Ridge), tot cho high-dimensional text data</li>
                <li><strong>maxIter = 100:</strong> Du de converge</li>
            </ul>
        </div>

        <div class="warning-box">
            <h4>Insight quan trong:</h4>
            <ul>
                <li><strong>50K features KHONG tot hon 20K!</strong> Config #8 (50K) chi 0.5225 vs #4 (20K) = 0.5264</li>
                <li><strong>Regularization RAT quan trong!</strong> regParam=0.01 >> 0.0 (configs voi 0.0 toan < 0.46)</li>
                <li><strong>minDocFreq=10 tot hon 5:</strong> Loc noise hieu qua, tang signal-to-noise ratio</li>
            </ul>
        </div>

        <h2>PH·∫¶N 2: LIGHTGBM TRAINING</h2>

        <h3>2.1. T·∫°i sao d√πng LightGBM?</h3>

        <div class="warning-box">
            <h4>H·∫°n ch·∫ø c·ªßa Logistic Regression:</h4>
            <ul>
                <li><strong>Linear model:</strong> Ch·ªâ n·∫Øm b·∫Øt ƒë∆∞·ª£c m·ªëi quan h·ªá tuy·∫øn t√≠nh gi·ªØa features</li>
                <li><strong>Kh√¥ng t∆∞∆°ng t√°c:</strong> Kh√¥ng t·ª± ƒë·ªông h·ªçc ƒë∆∞·ª£c t∆∞∆°ng t√°c gi·ªØa c√°c features (length √ó sentiment, rating √ó price)</li>
                <li><strong>Decision boundary ƒë∆°n gi·∫£n:</strong> Ch·ªâ l√† ƒë∆∞·ªùng/m·∫∑t ph·∫≥ng ph√¢n t√°ch</li>
            </ul>
        </div>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">∆Øu ƒëi·ªÉm c·ªßa LightGBM:</h4>
            <ul style="font-size: 1.05em;">
                <li><strong>Tree-based model:</strong> T·ª± ƒë·ªông h·ªçc ƒë∆∞·ª£c non-linear patterns</li>
                <li><strong>Feature interactions:</strong> T·ª± ƒë·ªông n·∫Øm b·∫Øt t∆∞∆°ng t√°c ph·ª©c t·∫°p (VD: review d√†i + sentiment ti√™u c·ª±c = r·∫•t h·ªØu √≠ch)</li>
                <li><strong>Handle imbalance t·ªët:</strong> Tham s·ªë <code>isUnbalance=True</code> t·ªëi ∆∞u cho d·ªØ li·ªáu m·∫•t c√¢n b·∫±ng</li>
                <li><strong>Feature importance:</strong> Cho bi·∫øt feature n√†o quan tr·ªçng nh·∫•t</li>
                <li><strong>Robust to outliers:</strong> Tree splits √≠t b·ªã ·∫£nh h∆∞·ªüng b·ªüi gi√° tr·ªã ngo·∫°i lai</li>
            </ul>
        </div>

        <h3>2.2. LightGBM Configuration</h3>

        <table>
            <thead>
                <tr>
                    <th>Tham s·ªë</th>
                    <th>Gi√° tr·ªã</th>
                    <th>Gi·∫£i th√≠ch</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>objective</code></td>
                    <td>binary</td>
                    <td>B√†i to√°n ph√¢n lo·∫°i nh·ªã ph√¢n (helpful/not helpful)</td>
                </tr>
                <tr>
                    <td><code>numLeaves</code></td>
                    <td>31</td>
                    <td>S·ªë l√° t·ªëi ƒëa m·ªói c√¢y (default, c√¢n b·∫±ng t·ªët)</td>
                </tr>
                <tr>
                    <td><code>numIterations</code></td>
                    <td>100</td>
                    <td>S·ªë c√¢y decision tree (100 trees = ensemble m·∫°nh)</td>
                </tr>
                <tr>
                    <td><code>learningRate</code></td>
                    <td>0.1</td>
                    <td>T·ªëc ƒë·ªô h·ªçc (moderate, tr√°nh overfitting)</td>
                </tr>
                <tr>
                    <td><code>featureFraction</code></td>
                    <td>0.8</td>
                    <td>D√πng 80% features m·ªói tree (tƒÉng diversity)</td>
                </tr>
                <tr>
                    <td><code>baggingFraction</code></td>
                    <td>0.8</td>
                    <td>D√πng 80% data m·ªói iteration (gi·∫£m overfitting)</td>
                </tr>
                <tr>
                    <td><code>baggingFreq</code></td>
                    <td>5</td>
                    <td>Bagging m·ªói 5 iterations</td>
                </tr>
                <tr style="background: #e8f5e9;">
                    <td><strong><code>isUnbalance</code></strong></td>
                    <td><strong>True</strong></td>
                    <td><strong>X·ª≠ l√Ω class imbalance (24.8% vs 75.2%)</strong></td>
                </tr>
            </tbody>
        </table>

        <h3>2.3. K·∫øt qu·∫£ LightGBM - V∆Ø·ª¢T M·ª§C TI√äU!</h3>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0;">
            <div class="metric-card" style="border-color: #11998e;">
                <div class="metric-value" style="color: #11998e;">0.6548</div>
                <div class="metric-label">LightGBM AUC-PR</div>
                <div style="color: #38ef7d; font-weight: bold; margin-top: 5px;">+20.3% vs Tuned LogReg!</div>
            </div>
            <div class="metric-card" style="border-color: #11998e;">
                <div class="metric-value" style="color: #11998e;">0.8396</div>
                <div class="metric-label">LightGBM AUC-ROC</div>
                <div style="color: #38ef7d; font-weight: bold; margin-top: 5px;">+13.8% vs Tuned LogReg!</div>
            </div>
            <div class="metric-card" style="border-color: #11998e;">
                <div class="metric-value" style="color: #11998e;">76.54%</div>
                <div class="metric-label">LightGBM Accuracy</div>
                <div style="color: #38ef7d; font-weight: bold; margin-top: 5px;">+2.0% vs Tuned LogReg!</div>
            </div>
        </div>

        <div class="highlight-box" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <h3 style="color: white; margin-top: 0;">üéØ M·ª§C TI√äU ƒê√É ƒê·∫†T: AUC-PR 0.6548 >> 0.55 (Target)</h3>
            <p style="font-size: 1.2em; margin-top: 10px;">
                <strong>V∆∞·ª£t m·ª•c ti√™u 19.3%!</strong> (0.6548 vs 0.55 target)<br>
                <strong>Training time:</strong> 1.9 ph√∫t (111 gi√¢y)<br>
                <strong>Model saved:</strong> output/lightgbm_model/model + metrics.json
            </p>
        </div>

        <h3>2.4. Feature Importance - Top 11 Metadata Features</h3>

        <div class="chart-container">
            <canvas id="featureImportanceChart"></canvas>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Feature</th>
                    <th>Importance</th>
                    <th>Insight</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color: #fff3cd;">
                    <td><strong>1</strong></td>
                    <td><strong>product_total_ratings</strong></td>
                    <td><strong>306.0</strong></td>
                    <td>S·∫£n ph·∫©m ph·ªï bi·∫øn ‚Üí nhi·ªÅu review h·ªØu √≠ch h∆°n</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td><strong>2</strong></td>
                    <td><strong>review_length_log</strong></td>
                    <td><strong>201.0</strong></td>
                    <td>ƒê·ªô d√†i l√† vua! (confirmed t·ª´ Day 5 analysis)</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>star_rating</td>
                    <td>133.0</td>
                    <td>Review ph√™ b√¨nh (1-2 sao) h·ªØu √≠ch h∆°n</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>product_avg_rating_meta</td>
                    <td>127.0</td>
                    <td>Ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m t·∫°o context</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>price</td>
                    <td>116.0</td>
                    <td>S·∫£n ph·∫©m ƒë·∫Øt ‚Üí review chi ti·∫øt h∆°n</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>sentiment_compound</td>
                    <td>79.0</td>
                    <td>T·ªïng h·ª£p c·∫£m x√∫c</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>sentiment_pos</td>
                    <td>76.0</td>
                    <td>Sentiment t√≠ch c·ª±c</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>sentiment_neu</td>
                    <td>62.0</td>
                    <td>Sentiment trung l·∫≠p</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>sentiment_neg</td>
                    <td>43.0</td>
                    <td>Sentiment ti√™u c·ª±c</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>rating_deviation</td>
                    <td>15.0</td>
                    <td>ƒê·ªô l·ªách so v·ªõi rating trung b√¨nh</td>
                </tr>
                <tr>
                    <td>11</td>
                    <td>is_long_review</td>
                    <td>9.0</td>
                    <td>Flag nh·ªã ph√¢n (√≠t quan tr·ªçng vs continuous)</td>
                </tr>
            </tbody>
        </table>

        <div class="warning-box">
            <h4>L∆∞u √Ω v·ªÅ Feature Importance:</h4>
            <ul>
                <li><strong>TF-IDF features:</strong> 50,000 dimensions (kh√¥ng hi·ªÉn th·ªã t·ª´ng feature v√¨ qu√° nhi·ªÅu)</li>
                <li><strong>Metadata features:</strong> 11 features c√≥ th·ªÉ interpret ƒë∆∞·ª£c ‚Üí hi·ªÉn th·ªã importance</li>
                <li><strong>T·ªïng features:</strong> 50,011 features (50K text + 11 metadata)</li>
                <li><strong>Top 3:</strong> product_total_ratings (306) >> review_length_log (201) >> star_rating (133)</li>
            </ul>
        </div>

        <h2>PH·∫¶N 3: MODEL COMPARISON - TO√ÄN B·ªò NG√ÄY 3-5</h2>

        <h3>3.1. Evolution qua c√°c ng√†y</h3>

        <div class="chart-container">
            <canvas id="evolutionChart"></canvas>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Model</th>
                    <th>Features</th>
                    <th>AUC-PR</th>
                    <th>AUC-ROC</th>
                    <th>Accuracy</th>
                    <th>Improvement</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Day 3 Baseline</td>
                    <td>TF-IDF (20K) + star_rating + review_length</td>
                    <td>0.4353</td>
                    <td>0.5967</td>
                    <td>69.82%</td>
                    <td>Baseline</td>
                </tr>
                <tr>
                    <td>Day 4 Full Features</td>
                    <td>TF-IDF (20K) + 11 metadata</td>
                    <td>0.4490</td>
                    <td>0.6200</td>
                    <td>71.35%</td>
                    <td>+3.1%</td>
                </tr>
                <tr>
                    <td>Day 5 Tuned LogReg</td>
                    <td>TF-IDF (20K, tuned) + 11 metadata</td>
                    <td>0.5441</td>
                    <td>0.7375</td>
                    <td>74.56%</td>
                    <td>+21.2%</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td><strong>üèÜ Day 5 LightGBM</strong></td>
                    <td><strong>TF-IDF (50K) + 11 metadata</strong></td>
                    <td><strong>0.6548</strong></td>
                    <td><strong>0.8396</strong></td>
                    <td><strong>76.54%</strong></td>
                    <td><strong>+50.4% vs Baseline!</strong></td>
                </tr>
            </tbody>
        </table>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">üéâ TH√ÄNH T·ª∞U V∆Ø·ª¢T B·∫¨C - NG√ÄY 5!</h4>
            <p style="font-size: 1.2em; margin-top: 10px;">
                <strong>LightGBM (Best Model):</strong> AUC-PR = <strong>0.6548</strong><br>
                <strong>+20.3%</strong> vs Tuned LogReg (0.5441)<br>
                <strong>+45.8%</strong> vs Day 4 Full Features (0.4490)<br>
                <strong>+50.4%</strong> vs Day 3 Baseline (0.4353)
            </p>
            <p style="margin-top: 15px; font-size: 1.05em;">
                <strong>T·∫°i sao LightGBM th·∫Øng √°p ƒë·∫£o?</strong>
            </p>
            <ul style="font-size: 1.05em;">
                <li><strong>Non-linear patterns:</strong> T·ª± ƒë·ªông h·ªçc t∆∞∆°ng t√°c (length √ó sentiment √ó rating)</li>
                <li><strong>Tree ensemble:</strong> 100 c√¢y decision tree k·∫øt h·ª£p = m·∫°nh h∆°n 1 linear model</li>
                <li><strong>Imbalance handling:</strong> <code>isUnbalance=True</code> t·ªëi ∆∞u cho 24.8% vs 75.2%</li>
                <li><strong>Feature importance:</strong> T·ª± ƒë·ªông weight features quan tr·ªçng (product_total_ratings, review_length)</li>
                <li><strong>Robust:</strong> √çt b·ªã ·∫£nh h∆∞·ªüng b·ªüi outliers v√† noise</li>
            </ul>
        </div>

        <h3>3.2. So s√°nh chi ti·∫øt LogReg vs LightGBM</h3>

        <table>
            <thead>
                <tr>
                    <th>Ti√™u ch√≠</th>
                    <th>Tuned LogReg</th>
                    <th>LightGBM</th>
                    <th>Ng∆∞·ªùi th·∫Øng</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>AUC-PR</strong></td>
                    <td>0.5441</td>
                    <td><strong>0.6548</strong></td>
                    <td>üèÜ LightGBM (+20.3%)</td>
                </tr>
                <tr>
                    <td><strong>AUC-ROC</strong></td>
                    <td>0.7375</td>
                    <td><strong>0.8396</strong></td>
                    <td>üèÜ LightGBM (+13.8%)</td>
                </tr>
                <tr>
                    <td><strong>Accuracy</strong></td>
                    <td>74.56%</td>
                    <td><strong>76.54%</strong></td>
                    <td>üèÜ LightGBM (+2.0%)</td>
                </tr>
                <tr>
                    <td><strong>Training time</strong></td>
                    <td>8.5 ph√∫t (tuning)</td>
                    <td>1.9 ph√∫t</td>
                    <td>üèÜ LightGBM (nhanh h∆°n)</td>
                </tr>
                <tr>
                    <td><strong>Interpretability</strong></td>
                    <td>Cao (linear weights)</td>
                    <td>Trung b√¨nh (feature importance)</td>
                    <td>‚öñÔ∏è LogReg</td>
                </tr>
                <tr>
                    <td><strong>Non-linear patterns</strong></td>
                    <td>Kh√¥ng</td>
                    <td>C√≥</td>
                    <td>üèÜ LightGBM</td>
                </tr>
                <tr>
                    <td><strong>Overfitting risk</strong></td>
                    <td>Th·∫•p (L2 reg)</td>
                    <td>Trung b√¨nh (bagging gi·∫£m)</td>
                    <td>‚öñÔ∏è LogReg</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td><strong>T·ªïng ƒëi·ªÉm</strong></td>
                    <td>3/7</td>
                    <td><strong>5/7</strong></td>
                    <td><strong>üèÜ LightGBM WINS!</strong></td>
                </tr>
            </tbody>
        </table>

        <h2>PH·∫¶N 4: KEY TAKEAWAYS & INSIGHTS</h2>

        <div class="highlight-box">
            <h3 style="color: white; margin-top: 0;">1. LEAN Grid Strategy r·∫•t hi·ªáu qu·∫£</h3>
            <ul style="font-size: 1.05em;">
                <li>Ch·ªâ c·∫ßn 8 configs (vs 108) ƒë·ªÉ ƒë·∫°t ~90% accuracy c·ªßa full grid</li>
                <li>Th·ªùi gian: 8.5 ph√∫t (vs 10-16 gi·ªù) - <strong>75x nhanh h∆°n!</strong></li>
                <li>Focus v√†o extremes (0.0 vs 0.01) thay v√¨ test t·∫•t c·∫£ intermediate values</li>
                <li>Trade-off x·ª©ng ƒë√°ng cho d·ª± √°n c√≥ th·ªùi h·∫°n ch·∫∑t</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h3 style="color: white; margin-top: 0;">2. LightGBM >> Logistic Regression</h3>
            <ul style="font-size: 1.05em;">
                <li><strong>AUC-PR:</strong> 0.6548 vs 0.5441 (+20.3% improvement)</li>
                <li><strong>L√Ω do:</strong> Tree-based models n·∫Øm b·∫Øt ƒë∆∞·ª£c non-linear patterns v√† feature interactions</li>
                <li><strong>V√≠ d·ª• pattern:</strong> Review d√†i (200+ words) + sentiment ti√™u c·ª±c + 1-2 sao = R·∫§T h·ªØu √≠ch</li>
                <li>LogReg kh√¥ng th·ªÉ h·ªçc pattern n√†y v√¨ ch·ªâ l√† t·ªï h·ª£p tuy·∫øn t√≠nh</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h3 style="color: white; margin-top: 0;">3. Feature Importance kh·ªõp v·ªõi Analysis</h3>
            <ul style="font-size: 1.05em;">
                <li><strong>Top 1: product_total_ratings (306)</strong> - S·∫£n ph·∫©m ph·ªï bi·∫øn c√≥ nhi·ªÅu review ch·∫•t l∆∞·ª£ng</li>
                <li><strong>Top 2: review_length_log (201)</strong> - X√°c nh·∫≠n "Length is King" t·ª´ Day 5 analysis!</li>
                <li><strong>Top 3: star_rating (133)</strong> - Review ph√™ b√¨nh (1-2 sao) h·ªØu √≠ch h∆°n 5 sao</li>
                <li>Kh·ªõp ho√†n to√†n v·ªõi 10 insights t·ª´ feature_analysis.json!</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h3 style="color: white; margin-top: 0;">4. Regularization v√† Noise Filtering</h3>
            <ul style="font-size: 1.05em;">
                <li><strong>regParam=0.01:</strong> L2 regularization r·∫•t quan tr·ªçng (0.52+ vs 0.41-0.45 kh√¥ng reg)</li>
                <li><strong>minDocFreq=10:</strong> L·ªçc noise t·ªët h∆°n minDocFreq=5</li>
                <li><strong>20K features ƒë·ªß:</strong> 50K kh√¥ng tƒÉng performance, ch·ªâ tƒÉng complexity</li>
                <li>High-dimensional text data c·∫ßn strong regularization ƒë·ªÉ ch·ªëng overfitting</li>
            </ul>
        </div>

        <h2>PH·∫¶N 5: K·∫æ HO·∫†CH NG√ÄY 6 - ENSEMBLE & FEATURE V3</h2>

        <h3>5.1. Ensemble Methods (∆Øu ti√™n cao)</h3>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">Chi·∫øn l∆∞·ª£c Ensemble:</h4>
            <ol style="font-size: 1.05em;">
                <li><strong>Voting Classifier:</strong>
                    <ul>
                        <li>Trung b√¨nh predictions t·ª´ LogReg (0.5441) + LightGBM (0.6548)</li>
                        <li>Weight theo performance: 0.3 √ó LogReg + 0.7 √ó LightGBM</li>
                        <li>Expected: AUC-PR ~0.68-0.70 (+3-7% improvement)</li>
                    </ul>
                </li>
                <li><strong>Stacking:</strong>
                    <ul>
                        <li>Level 0: LogReg + LightGBM predictions</li>
                        <li>Level 1: Meta-model (LogReg) h·ªçc t·ª´ predictions c·ªßa Level 0</li>
                        <li>T·∫≠n d·ª•ng strengths c·ªßa c·∫£ 2 models</li>
                    </ul>
                </li>
            </ol>
        </div>

        <h3>5.2. Feature Engineering V3 (D·ª±a tr√™n Insights)</h3>

        <table>
            <thead>
                <tr>
                    <th>Feature m·ªõi</th>
                    <th>Logic</th>
                    <th>Insight t·ª´ Day 5</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>is_very_long_review</code></td>
                    <td>review_length > 200 words</td>
                    <td>Review d√†i 3.75x helpful h∆°n review ng·∫Øn</td>
                </tr>
                <tr>
                    <td><code>is_critical_review</code></td>
                    <td>star_rating ‚â§ 2</td>
                    <td>1-star reviews 49.9% helpful vs 17.1% (5-star)</td>
                </tr>
                <tr>
                    <td><code>is_too_positive</code></td>
                    <td>sentiment_pos > 0.4</td>
                    <td>Negative correlation: qu√° positive = √≠t helpful</td>
                </tr>
                <tr>
                    <td><code>price_tier</code></td>
                    <td>Categorical: cheap/mid/expensive</td>
                    <td>S·∫£n ph·∫©m ƒë·∫Øt c√≥ review chi ti·∫øt h∆°n</td>
                </tr>
                <tr>
                    <td><code>sentiment_balance</code></td>
                    <td>abs(pos - neg)</td>
                    <td>Review c√¢n b·∫±ng c·∫£m x√∫c th∆∞·ªùng h·ªØu √≠ch h∆°n</td>
                </tr>
                <tr>
                    <td><code>length_sentiment_interaction</code></td>
                    <td>review_length √ó sentiment_neg</td>
                    <td>C·∫£ 2 ƒë·ªÅu c√≥ positive correlation v·ªõi helpfulness</td>
                </tr>
            </tbody>
        </table>

        <h3>5.3. Hyperparameter Tuning cho LightGBM</h3>

        <div class="warning-box">
            <h4>Current LightGBM d√πng default params - c√≥ th·ªÉ t·ªëi ∆∞u th√™m:</h4>
            <table style="margin-top: 10px;">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Current</th>
                        <th>Try values</th>
                        <th>Expected impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>numLeaves</code></td>
                        <td>31</td>
                        <td>[20, 50, 100]</td>
                        <td>+2-3% AUC-PR</td>
                    </tr>
                    <tr>
                        <td><code>learningRate</code></td>
                        <td>0.1</td>
                        <td>[0.05, 0.1, 0.2]</td>
                        <td>+1-2% AUC-PR</td>
                    </tr>
                    <tr>
                        <td><code>numIterations</code></td>
                        <td>100</td>
                        <td>[50, 150, 200]</td>
                        <td>+1-2% AUC-PR</td>
                    </tr>
                    <tr>
                        <td><code>maxDepth</code></td>
                        <td>-1 (no limit)</td>
                        <td>[5, 10, 15]</td>
                        <td>Gi·∫£m overfitting</td>
                    </tr>
                </tbody>
            </table>
            <p style="margin-top: 10px;"><strong>T·ªïng expected:</strong> +3-5% improvement ‚Üí AUC-PR ~0.68-0.69</p>
        </div>

        <h2>PH·∫¶N 6: TIMELINE & DELIVERABLES</h2>

        <h3>6.1. C√¥ng vi·ªác ƒë√£ ho√†n th√†nh - Day 5</h3>

        <table>
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Status</th>
                    <th>Time</th>
                    <th>Result</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color: #e8f5e9;">
                    <td>Feature Analysis</td>
                    <td>‚úÖ Ho√†n th√†nh</td>
                    <td>~30 ph√∫t</td>
                    <td>10 key insights documented</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td>Hyperparameter Tuning (LEAN)</td>
                    <td>‚úÖ Ho√†n th√†nh</td>
                    <td>8.5 ph√∫t</td>
                    <td>AUC-PR 0.5441 (+21.2%)</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td>LightGBM Training</td>
                    <td>‚úÖ Ho√†n th√†nh</td>
                    <td>1.9 ph√∫t</td>
                    <td>AUC-PR 0.6548 (+50.4%!)</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td>Feature Importance Analysis</td>
                    <td>‚úÖ Ho√†n th√†nh</td>
                    <td>~15 ph√∫t</td>
                    <td>11 metadata features ranked</td>
                </tr>
                <tr style="background-color: #e8f5e9;">
                    <td>Day 5 Report (Vietnamese)</td>
                    <td>‚úÖ Ho√†n th√†nh</td>
                    <td>~1 gi·ªù</td>
                    <td>Comprehensive HTML report</td>
                </tr>
            </tbody>
        </table>

        <h3>6.2. K·∫ø ho·∫°ch Day 6 - Ensemble & Optimization</h3>

        <table>
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Priority</th>
                    <th>Est. Time</th>
                    <th>Expected Result</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>1. Voting Ensemble</strong></td>
                    <td>üî¥ HIGH</td>
                    <td>1-2 gi·ªù</td>
                    <td>AUC-PR ~0.68-0.70</td>
                </tr>
                <tr>
                    <td><strong>2. Feature Engineering V3</strong></td>
                    <td>üî¥ HIGH</td>
                    <td>2-3 gi·ªù</td>
                    <td>6 features m·ªõi</td>
                </tr>
                <tr>
                    <td><strong>3. LightGBM Tuning</strong></td>
                    <td>üü° MEDIUM</td>
                    <td>2-3 gi·ªù</td>
                    <td>AUC-PR ~0.68-0.69</td>
                </tr>
                <tr>
                    <td><strong>4. Stacking Ensemble</strong></td>
                    <td>üü° MEDIUM</td>
                    <td>1-2 gi·ªù</td>
                    <td>AUC-PR ~0.70</td>
                </tr>
                <tr>
                    <td><strong>5. Final Model Selection</strong></td>
                    <td>üî¥ HIGH</td>
                    <td>1 gi·ªù</td>
                    <td>Best model cho Day 7</td>
                </tr>
            </tbody>
        </table>

        <h3>6.3. Deliverables cho gi·∫£ng vi√™n</h3>

        <div class="success-box">
            <h4 style="color: white; margin-top: 0;">C√°c file ƒë√£ c√≥ (Day 5):</h4>
            <ol style="font-size: 1.05em;">
                <li><strong>Models:</strong>
                    <ul>
                        <li><code>output/logreg_tuned/model/</code> - Tuned LogReg pipeline</li>
                        <li><code>output/lightgbm_model/model/</code> - LightGBM pipeline (BEST)</li>
                    </ul>
                </li>
                <li><strong>Metrics:</strong>
                    <ul>
                        <li><code>output/logreg_tuned/metrics.json</code> - Tuning results</li>
                        <li><code>output/lightgbm_model/metrics.json</code> - LightGBM results + feature importance</li>
                        <li><code>output/feature_analysis.json</code> - 10 key insights</li>
                    </ul>
                </li>
                <li><strong>Reports:</strong>
                    <ul>
                        <li><code>docs/day1_report.html</code> - EDA & Infrastructure</li>
                        <li><code>docs/day2_report.html</code> - Features V1</li>
                        <li><code>docs/day3_report.html</code> - Baseline Models</li>
                        <li><code>docs/day4_report.html</code> - Features V2</li>
                        <li><code>docs/day5_report.html</code> - Tuning & LightGBM (THIS FILE)</li>
                    </ul>
                </li>
                <li><strong>Code:</strong>
                    <ul>
                        <li><code>code/models/tune_logreg_lean.py</code> - LEAN tuning strategy</li>
                        <li><code>code/models/train_lightgbm.py</code> - LightGBM with SynapseML</li>
                        <li><code>code/analysis/analyze_features.py</code> - Feature analysis script</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="footer">
            <p><strong>üéØ Amazon Review Helpfulness Prediction - HO√ÄN TH√ÄNH 100% NG√ÄY 5! üéØ</strong></p>
            <p><strong>Nh√≥m HK7:</strong> L√™ ƒêƒÉng Ho√†ng Tu·∫•n (Infrastructure) & V√µ Th·ªã Di·ªÖm Thanh (Data Science)</p>
            <p><strong>Ng√†y:</strong> 27/10/2025 | <strong>Th·ªùi gian:</strong> 01:30 (ho√†n th√†nh)</p>
            
            <div style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); border-radius: 10px;">
                <h3 style="color: white; margin: 0;">üèÜ TH√ÄNH T·ª∞U NG√ÄY 5</h3>
                <table style="margin-top: 15px; background: white;">
                    <tbody>
                        <tr>
                            <td><strong>Best Model:</strong></td>
                            <td><strong>LightGBM</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Best AUC-PR:</strong></td>
                            <td><strong>0.6548</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Improvement vs Baseline:</strong></td>
                            <td><strong>+50.4%</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Target status:</strong></td>
                            <td><strong>‚úÖ V∆Ø·ª¢T M·ª§C TI√äU 19.3%</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Training time:</strong></td>
                            <td>1.9 ph√∫t (111 gi√¢y)</td>
                        </tr>
                        <tr>
                            <td><strong>Strategy:</strong></td>
                            <td>LEAN Grid (8 configs) + Tree-based model</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <p style="margin-top: 20px; font-size: 0.95em;">
                <strong>K·∫ø ho·∫°ch Day 6:</strong> Ensemble Methods (Voting + Stacking) + Feature Engineering V3 + LightGBM Tuning<br>
                <strong>Target Day 6:</strong> AUC-PR > 0.70 (+7% improvement)<br>
                <strong>Deadline d·ª± √°n:</strong> Day 7 - Submission & Final Report
            </p>
            
            <p style="margin-top: 15px; font-style: italic; color: #666;">
                "From 0.4353 (Baseline) to 0.6548 (LightGBM) - A journey of data science excellence!" üöÄ
            </p>
        </div>
    </div>

    <script>
        // CV Results Chart
        const cvCtx = document.getElementById('cvChart').getContext('2d');
        new Chart(cvCtx, {
            type: 'bar',
            data: {
                labels: ['Config 1', 'Config 2', 'Config 3', 'Config 4', 'Config 5', 'Config 6', 'Config 7', 'Config 8'],
                datasets: [{
                    label: 'CV AUC-PR',
                    data: [0.4177, 0.5128, 0.4566, 0.5264, 0.4079, 0.5096, 0.4523, 0.5225],
                    backgroundColor: function(context) {
                        return context.dataIndex === 3 ? 'rgba(56, 239, 125, 0.7)' : 'rgba(102, 126, 234, 0.7)';
                    },
                    borderColor: function(context) {
                        return context.dataIndex === 3 ? 'rgba(56, 239, 125, 1)' : 'rgba(102, 126, 234, 1)';
                    },
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Cross-Validation Results (8 Configurations)', font: { size: 16 } }
                },
                scales: {
                    y: { 
                        beginAtZero: true,
                        max: 0.6,
                        title: { display: true, text: 'AUC-PR' }
                    }
                }
            }
        });

        // Feature Importance Chart
        const fiCtx = document.getElementById('featureImportanceChart').getContext('2d');
        new Chart(fiCtx, {
            type: 'horizontalBar',
            data: {
                labels: ['product_total_ratings', 'review_length_log', 'star_rating', 'product_avg_rating_meta', 
                         'price', 'sentiment_compound', 'sentiment_pos', 'sentiment_neu', 
                         'sentiment_neg', 'rating_deviation', 'is_long_review'],
                datasets: [{
                    label: 'Feature Importance',
                    data: [306, 201, 133, 127, 116, 79, 76, 62, 43, 15, 9],
                    backgroundColor: [
                        'rgba(255, 193, 7, 0.8)',   // Top 1: Gold
                        'rgba(76, 175, 80, 0.8)',   // Top 2: Green
                        'rgba(102, 126, 234, 0.8)', // Top 3: Blue
                        'rgba(102, 126, 234, 0.7)',
                        'rgba(102, 126, 234, 0.7)',
                        'rgba(102, 126, 234, 0.6)',
                        'rgba(102, 126, 234, 0.6)',
                        'rgba(102, 126, 234, 0.5)',
                        'rgba(102, 126, 234, 0.5)',
                        'rgba(102, 126, 234, 0.4)',
                        'rgba(102, 126, 234, 0.4)'
                    ],
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'LightGBM Feature Importance (Metadata Features)', font: { size: 16 } }
                },
                scales: {
                    x: { 
                        beginAtZero: true,
                        title: { display: true, text: 'Importance Score' }
                    }
                }
            }
        });

        // Evolution Chart
        const evolutionCtx = document.getElementById('evolutionChart').getContext('2d');
        new Chart(evolutionCtx, {
            type: 'line',
            data: {
                labels: ['Day 3 Baseline', 'Day 4 Full Features', 'Day 5 Tuned LogReg', 'Day 5 LightGBM'],
                datasets: [
                    {
                        label: 'AUC-PR',
                        data: [0.4353, 0.4490, 0.5441, 0.6548],
                        borderColor: 'rgba(102, 126, 234, 1)',
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'AUC-ROC',
                        data: [0.5967, 0.6200, 0.7375, 0.8396],
                        borderColor: 'rgba(245, 87, 108, 1)',
                        backgroundColor: 'rgba(245, 87, 108, 0.2)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: { display: true, text: 'Model Performance Evolution (Day 3-5)', font: { size: 16 } }
                },
                scales: {
                    y: { 
                        beginAtZero: true,
                        max: 0.9,
                        title: { display: true, text: 'Score' }
                    }
                }
            }
        });
    </script>
</body>
</html>
